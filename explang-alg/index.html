
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/opsit-io/opsit-explang-docs/explang-alg/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.2">
    
    
      
        <title>Using Explang with Algebraic Syntax - Explang Documentation Site</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-on-using-explang-with-algebraic-syntax" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Explang Documentation Site" class="md-header__button md-logo" aria-label="Explang Documentation Site" data-md-component="logo">
      
  <img src="../site_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Explang Documentation Site
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using Explang with Algebraic Syntax
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Explang Documentation Site" class="md-nav__button md-logo" aria-label="Explang Documentation Site" data-md-component="logo">
      
  <img src="../site_logo.png" alt="logo">

    </a>
    Explang Documentation Site
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Explang Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-goals-and-features/" class="md-nav__link">
        Explang Goals and Features
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-core-quick-start/" class="md-nav__link">
        Quick Start for Explang Core
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-alg-syntax-quick-start/" class="md-nav__link">
        Quick Start for Explang Algebraic Syntax
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-from-java/" class="md-nav__link">
        Calling Explang from Java
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-extending/" class="md-nav__link">
        Extending Explang in Java
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Using Explang with Algebraic Syntax
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Using Explang with Algebraic Syntax
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#expressions" class="md-nav__link">
    Expressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comments" class="md-nav__link">
    Comments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symbols-and-their-values" class="md-nav__link">
    Symbols and their Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-lists" class="md-nav__link">
    Creating lists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-functions" class="md-nav__link">
    Defining Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#short-lambda-definitions" class="md-nav__link">
    Short Lambda Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-values" class="md-nav__link">
    Function Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-help-on-functions" class="md-nav__link">
    Getting Help on Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#printing-values" class="md-nav__link">
    Printing values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return-value-of-the-function" class="md-nav__link">
    Return Value of the Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-and-vararg-arguments-for-functions" class="md-nav__link">
    Optional and Vararg Arguments for Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keyword-arguments" class="md-nav__link">
    Keyword arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-types-and-values" class="md-nav__link">
    Data Types and Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nil-values" class="md-nav__link">
    NIL values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#booleans" class="md-nav__link">
    Booleans
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numeric-types-and-values" class="md-nav__link">
    Numeric Types And Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numeric-types-promotions" class="md-nav__link">
    Numeric Types Promotions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-to-numeric-types" class="md-nav__link">
    Converting to Numeric Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    Strings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-interpolation" class="md-nav__link">
    String Interpolation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#character-type" class="md-nav__link">
    Character Type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collection-and-sequence-types" class="md-nav__link">
    Collection and Sequence types
  </a>
  
    <nav class="md-nav" aria-label="Collection and Sequence types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lists" class="md-nav__link">
    Lists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maps" class="md-nav__link">
    Maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    Sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    Arrays
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-sequences" class="md-nav__link">
    Character Sequences
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-information-about-collections-and-sequences" class="md-nav__link">
    Getting Information About Collections and Sequences
  </a>
  
    <nav class="md-nav" aria-label="Getting Information About Collections and Sequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-check-if-a-collection-contains-an-object" class="md-nav__link">
    in check if a collection contains an object.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-data-in-collections-and-objects" class="md-nav__link">
    Accessing data in collections and Objects
  </a>
  
    <nav class="md-nav" aria-label="Accessing data in collections and Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-subscript-operator-k" class="md-nav__link">
    The Subscript Operator [k]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-dot-operator" class="md-nav__link">
    The . (dot) operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty-subscript" class="md-nav__link">
    Empty subscript []
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_in-function-access-values-in-nested-structures" class="md-nav__link">
    get_in function access values in nested structures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fields-operator" class="md-nav__link">
    fields operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select_keys-function-select-entries-by-their-keysindices" class="md-nav__link">
    select_keys function select entries by their keys/indices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first" class="md-nav__link">
    first
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-take-and-subseq" class="md-nav__link">
    rest, take and subseq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haskey" class="md-nav__link">
    haskey
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#destructuring-of-data-structures" class="md-nav__link">
    Destructuring of Data Structures
  </a>
  
    <nav class="md-nav" aria-label="Destructuring of Data Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#destructuring-of-sequences" class="md-nav__link">
    Destructuring of sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destructuring-of-nested-sequences" class="md-nav__link">
    Destructuring of Nested Sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destructuring-of-maps" class="md-nav__link">
    Destructuring of Maps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifying-data-in-collections" class="md-nav__link">
    Modifying data in collections
  </a>
  
    <nav class="md-nav" aria-label="Modifying data in collections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-put-element-value-into-an-associative-structure" class="md-nav__link">
    put! - put element value into an associative structure.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-assignment-operator-to-modify-data-structures" class="md-nav__link">
    Using the assignment operator to modify data structures.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-put_in-modify-value-in-a-hierarchy-of-nested-associative-structures" class="md-nav__link">
    the put_in! modify value in a hierarchy of nested associative structures.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    delete!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert-push-and-pop" class="md-nav__link">
    insert!, push! and pop!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    APPEND!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    reverse!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort-sort-a-sequence" class="md-nav__link">
    sort! sort a sequence.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collection-specific-access-functions" class="md-nav__link">
    Collection Specific Access functions
  </a>
  
    <nav class="md-nav" aria-label="Collection Specific Access functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aref-and-aset-array-member-access" class="md-nav__link">
    aref and aset! -- array member access.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assoc" class="md-nav__link">
    assoc!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifying-data-with-non-mutating-functions" class="md-nav__link">
    Modifying data with non-mutating functions
  </a>
  
    <nav class="md-nav" aria-label="Modifying data with non-mutating functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put" class="md-nav__link">
    put
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#searching-and-matching-text-data-using-regular-expressions" class="md-nav__link">
    Searching and Matching Text Data Using Regular Expressions
  </a>
  
    <nav class="md-nav" aria-label="Searching and Matching Text Data Using Regular Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-regex-patterns" class="md-nav__link">
    Creating Regex Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-globbing-patterns" class="md-nav__link">
    The Globbing Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-case-insensitive-regex-and-other-flags" class="md-nav__link">
    Creating a Case Insensitive Regex (and other flags)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matching-a-regex-to-a-string-with-groups" class="md-nav__link">
    Matching a Regex to a String with Groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-a-regex-substring-within-a-string-with-groups" class="md-nav__link">
    Finding a regex substring within a string with groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-all-substrings-that-match-within-a-string" class="md-nav__link">
    Finding all substrings that match within a string
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compound-expressions" class="md-nav__link">
    Compound Expressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" class="md-nav__link">
    Conditionals
  </a>
  
    <nav class="md-nav" aria-label="Conditionals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implicit-truth-values" class="md-nav__link">
    Implicit Truth values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-logical-operators" class="md-nav__link">
    The Logical operators
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iteration-operators" class="md-nav__link">
    Iteration Operators
  </a>
  
    <nav class="md-nav" aria-label="Iteration Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-in-loop" class="md-nav__link">
    for-in loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#while-loop" class="md-nav__link">
    while loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-iterator" class="md-nav__link">
    map iterator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapprod" class="md-nav__link">
    mapprod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reduce" class="md-nav__link">
    reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-of-exceptions" class="md-nav__link">
    Handling of Exceptions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope-and-binding-of-variables" class="md-nav__link">
    Scope and Binding of Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-construction" class="md-nav__link">
    LET construction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-assignment-operator-and-its-global-and-local-modifiers" class="md-nav__link">
    The Assignment Operator := and its GLOBAL and LOCAL Modifiers
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-alg-funcs-by-package/" class="md-nav__link">
        Explang/Alg funcs by Package
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-alg-funcs-by-name/" class="md-nav__link">
        Explang/Alg funcs by Name
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-examples-alg/" class="md-nav__link">
        Explang/Alg Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-lisp/" class="md-nav__link">
        Using Explang with Lisp Syntax
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-lisp-funcs-by-package/" class="md-nav__link">
        Explang/Lisp funcs by Package
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-lisp-funcs-by-name/" class="md-nav__link">
        Explang/Lisp funcs by Name
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../explang-examples-lisp/" class="md-nav__link">
        Explang/Lisp Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../using-explang-REPL/" class="md-nav__link">
        Using Explang REPL
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../acknowledgements/" class="md-nav__link">
        Acknowledgements
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#expressions" class="md-nav__link">
    Expressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comments" class="md-nav__link">
    Comments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symbols-and-their-values" class="md-nav__link">
    Symbols and their Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-lists" class="md-nav__link">
    Creating lists
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-functions" class="md-nav__link">
    Defining Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#short-lambda-definitions" class="md-nav__link">
    Short Lambda Definitions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-values" class="md-nav__link">
    Function Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-help-on-functions" class="md-nav__link">
    Getting Help on Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#printing-values" class="md-nav__link">
    Printing values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return-value-of-the-function" class="md-nav__link">
    Return Value of the Function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional-and-vararg-arguments-for-functions" class="md-nav__link">
    Optional and Vararg Arguments for Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keyword-arguments" class="md-nav__link">
    Keyword arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-types-and-values" class="md-nav__link">
    Data Types and Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nil-values" class="md-nav__link">
    NIL values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#booleans" class="md-nav__link">
    Booleans
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numeric-types-and-values" class="md-nav__link">
    Numeric Types And Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numeric-types-promotions" class="md-nav__link">
    Numeric Types Promotions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#converting-to-numeric-types" class="md-nav__link">
    Converting to Numeric Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    Strings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#string-interpolation" class="md-nav__link">
    String Interpolation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#character-type" class="md-nav__link">
    Character Type
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collection-and-sequence-types" class="md-nav__link">
    Collection and Sequence types
  </a>
  
    <nav class="md-nav" aria-label="Collection and Sequence types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lists" class="md-nav__link">
    Lists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maps" class="md-nav__link">
    Maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    Sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    Arrays
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#character-sequences" class="md-nav__link">
    Character Sequences
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-information-about-collections-and-sequences" class="md-nav__link">
    Getting Information About Collections and Sequences
  </a>
  
    <nav class="md-nav" aria-label="Getting Information About Collections and Sequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#in-check-if-a-collection-contains-an-object" class="md-nav__link">
    in check if a collection contains an object.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accessing-data-in-collections-and-objects" class="md-nav__link">
    Accessing data in collections and Objects
  </a>
  
    <nav class="md-nav" aria-label="Accessing data in collections and Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-subscript-operator-k" class="md-nav__link">
    The Subscript Operator [k]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-dot-operator" class="md-nav__link">
    The . (dot) operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty-subscript" class="md-nav__link">
    Empty subscript []
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_in-function-access-values-in-nested-structures" class="md-nav__link">
    get_in function access values in nested structures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fields-operator" class="md-nav__link">
    fields operator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select_keys-function-select-entries-by-their-keysindices" class="md-nav__link">
    select_keys function select entries by their keys/indices
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#first" class="md-nav__link">
    first
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rest-take-and-subseq" class="md-nav__link">
    rest, take and subseq
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haskey" class="md-nav__link">
    haskey
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#destructuring-of-data-structures" class="md-nav__link">
    Destructuring of Data Structures
  </a>
  
    <nav class="md-nav" aria-label="Destructuring of Data Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#destructuring-of-sequences" class="md-nav__link">
    Destructuring of sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destructuring-of-nested-sequences" class="md-nav__link">
    Destructuring of Nested Sequences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#destructuring-of-maps" class="md-nav__link">
    Destructuring of Maps
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifying-data-in-collections" class="md-nav__link">
    Modifying data in collections
  </a>
  
    <nav class="md-nav" aria-label="Modifying data in collections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-put-element-value-into-an-associative-structure" class="md-nav__link">
    put! - put element value into an associative structure.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-assignment-operator-to-modify-data-structures" class="md-nav__link">
    Using the assignment operator to modify data structures.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-put_in-modify-value-in-a-hierarchy-of-nested-associative-structures" class="md-nav__link">
    the put_in! modify value in a hierarchy of nested associative structures.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete" class="md-nav__link">
    delete!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insert-push-and-pop" class="md-nav__link">
    insert!, push! and pop!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#append" class="md-nav__link">
    APPEND!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    reverse!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort-sort-a-sequence" class="md-nav__link">
    sort! sort a sequence.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collection-specific-access-functions" class="md-nav__link">
    Collection Specific Access functions
  </a>
  
    <nav class="md-nav" aria-label="Collection Specific Access functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aref-and-aset-array-member-access" class="md-nav__link">
    aref and aset! -- array member access.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assoc" class="md-nav__link">
    assoc!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modifying-data-with-non-mutating-functions" class="md-nav__link">
    Modifying data with non-mutating functions
  </a>
  
    <nav class="md-nav" aria-label="Modifying data with non-mutating functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put" class="md-nav__link">
    put
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#searching-and-matching-text-data-using-regular-expressions" class="md-nav__link">
    Searching and Matching Text Data Using Regular Expressions
  </a>
  
    <nav class="md-nav" aria-label="Searching and Matching Text Data Using Regular Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-regex-patterns" class="md-nav__link">
    Creating Regex Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-globbing-patterns" class="md-nav__link">
    The Globbing Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-a-case-insensitive-regex-and-other-flags" class="md-nav__link">
    Creating a Case Insensitive Regex (and other flags)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matching-a-regex-to-a-string-with-groups" class="md-nav__link">
    Matching a Regex to a String with Groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-a-regex-substring-within-a-string-with-groups" class="md-nav__link">
    Finding a regex substring within a string with groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-all-substrings-that-match-within-a-string" class="md-nav__link">
    Finding all substrings that match within a string
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compound-expressions" class="md-nav__link">
    Compound Expressions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditionals" class="md-nav__link">
    Conditionals
  </a>
  
    <nav class="md-nav" aria-label="Conditionals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implicit-truth-values" class="md-nav__link">
    Implicit Truth values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-logical-operators" class="md-nav__link">
    The Logical operators
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iteration-operators" class="md-nav__link">
    Iteration Operators
  </a>
  
    <nav class="md-nav" aria-label="Iteration Operators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-in-loop" class="md-nav__link">
    for-in loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#while-loop" class="md-nav__link">
    while loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-iterator" class="md-nav__link">
    map iterator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter" class="md-nav__link">
    filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapprod" class="md-nav__link">
    mapprod
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reduce" class="md-nav__link">
    reduce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-of-exceptions" class="md-nav__link">
    Handling of Exceptions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scope-and-binding-of-variables" class="md-nav__link">
    Scope and Binding of Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-construction" class="md-nav__link">
    LET construction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-assignment-operator-and-its-global-and-local-modifiers" class="md-nav__link">
    The Assignment Operator := and its GLOBAL and LOCAL Modifiers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="tutorial-on-using-explang-with-algebraic-syntax">Tutorial on Using Explang with Algebraic Syntax</h1>
<h2 id="expressions">Expressions</h2>
<p>An Explang program is a sequence of one or more expressions which are evaluated
from the beginning to the end.</p>
<p>The language works with expressions that return values. There are no statements.</p>
<p>Expressions are separated by ';' and white-space is not significant; </p>
<p>The simplest expressions are things like numbers, booleans or strings, which
evaluate to themselves.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;foo bar&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="n">bar</span><span class="w"></span>
</code></pre></div>
<p>Explang supports regular algebraic syntax for building complex expressions
using operators and calls to functions:</p>
<div class="highlight"><pre><span></span><code><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mf">24.14213562373095</span><span class="w"></span>
</code></pre></div>
<p>All the operators like '+', '-', '*', etc are also available for use 
in functional form, for example, the same expression using <code>+</code> and <code>*</code>
in functional form:</p>
<div class="highlight"><pre><span></span><code><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mf">24.14213562373095</span><span class="w"></span>
</code></pre></div>
<p>The advantage of functional form is that you can call operators not with just two,
but with any number of arguments:</p>
<div class="highlight"><pre><span></span><code><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>

<span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="mi">1</span><span class="w"></span>

<span class="o">+</span><span class="p">()</span><span class="w"></span>

<span class="o">=&gt;</span><span class="mi">0</span><span class="w"></span>
</code></pre></div>
<h2 id="comments">Comments</h2>
<p>A line comment starts with the <code>#</code> character and runs until end of the line:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"> </span><span class="c"># a comment</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"></span>
</code></pre></div>
<p>Explang supports block comments as well, they are started by <code>#=</code> and run until 
first occurrence of <code>=#</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="cm">#= a block comment =#</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
</code></pre></div>
<h2 id="symbols-and-their-values">Symbols and their Values</h2>
<p>The expressions <code>+</code> and <code>*</code> here are Symbols. 
Symbols don't evaluate to themselves but return values they have been assigned.
If we give <code>b</code> the value 10, it will return 10 when evaluated:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="o">:=</span><span class="mi">10</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">b</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
</code></pre></div>
<p>If we try to evaluate a Symbol that has not been assigned a value we'll get error[^1].</p>
<p>Note that evaluation of <code>b:=10</code> when <code>b</code> still was unassigned did
not cause an error. </p>
<p>The symbols that start with letter ':' are special, they are
<code>keywords</code> -- symbols that are always assigned values of themselves.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="ss">:something</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="ss">:something</span><span class="w"></span>
</code></pre></div>
<p>They may be used for different kinds of identifiers: keys in map,
names of parameters, etc.</p>
<h2 id="creating-lists">Creating lists</h2>
<p>To create a list of values use the <code>[ ]</code> operator</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">:b</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>This operator is equivalent to function <code>list</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">:b</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h2 id="defining-functions">Defining Functions</h2>
<p>We've already seen some functions: <code>+</code>, <code>*</code>. You can define new ones
with the <code>function</code> operator. Here's a function that takes two numbers
and returns their average:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">27</span><span class="n">fe3806</span><span class="w"></span>
</code></pre></div>
<p>The operator expects a symbol to use as the name, a list of symbols
that describe the parameters, and then zero or more expressions called
the body.</p>
<p>When the function is called, those expressions will be evaluated in
order with the parameter symbols in the body temporarily set ('bound')
to the corresponding argument values. Whatever the last expression
returns will be returned as the value of the call.</p>
<p>The body of the function consists of one expression, <code>(x + y) / 2</code>.
It is common for functions to consist of one expression; in purely
functional code (code with no side-effects) they always do.</p>
<p>What is the object returned as the value of the <code>function</code> expression?
That's the Java Object that represents the function.</p>
<p>Now the symbol <code>average</code> is assigned function value and you can invoke
it in the same way you invoke the built-in functions like <code>+</code> or <code>*</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">150</span><span class="w"></span>
</code></pre></div>
<p>As the literal representation of a string is a series of characters
surrounded by double quotes, the literal representation of a function
is the language keyword <code>function</code>, followed by its
parameters, followed by its body. So you could represent a function to
return the average of two numbers as:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">37</span><span class="n">a71e93</span><span class="w"></span>
</code></pre></div>
<p>And you can call a literal function just like you can call it using the  symbol, e.g.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="k">function</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="k">end</span><span class="p">)(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">150</span><span class="w"></span>
</code></pre></div>
<h2 id="short-lambda-definitions">Short Lambda Definitions</h2>
<p>When the function body consists only of one function there is a
second, shorter syntax for defining an anonymous function in Explang.</p>
<p>The traditional syntax demonstrated above is equivalent to the shorter
version:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">71</span><span class="n">d15f18</span><span class="w"></span>
</code></pre></div>
<p>And when there is only one argument you can use even simpler form:</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">38364841</span><span class="w"></span>
</code></pre></div>
<h2 id="function-values">Function Values</h2>
<p>Notice that if you try to get the function object simply by referencing the <code>average</code> symbol you get an error.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="w"></span>
<span class="n">EXECUTION</span><span class="w"> </span><span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">RuntimeException</span><span class="o">:</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="err">&#39;</span><span class="n">average</span><span class="o">&#39;</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">at</span><span class="o">:</span><span class="w"></span>
</code></pre></div>
<p>This is because of an important property of Explang: named functions
and ordinary data variables are living in separate namespaces, that is
you may assign value to variable <code>average</code> without overwriting the
function <code>average</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="o">:=</span><span class="mi">100</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">average</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">150</span><span class="w"></span>
</code></pre></div>
<p>To reference the value of the defined function one must use special syntax:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="sa">f</span><span class="s">&quot;average&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mf">5e9</span><span class="n">f23b4</span><span class="w"></span>
</code></pre></div>
<p>To set the function binding one can use the <code>fset</code> function, all the
'function' operator does is basically:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">fset</span><span class="p">(</span><span class="w"> </span><span class="ss">:average</span><span class="p">,</span><span class="w">  </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">28</span><span class="n">c4711c</span><span class="w"></span>
</code></pre></div>
<h2 id="getting-help-on-functions">Getting Help on Functions</h2>
<p>To get short description of a function or a special operator use
<code>describe_function</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">describe_function</span><span class="p">(</span><span class="s">&quot;random&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">built</span><span class="o">-</span><span class="k">in</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Funcs</span><span class="o">$</span><span class="n">RANDOM</span><span class="w"></span>

<span class="n">Arguments</span><span class="o">:</span><span class="w">  </span><span class="n">limit</span><span class="w"></span>

<span class="n">Documentation</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">Produce</span><span class="w"> </span><span class="n">Pseudo</span><span class="o">-</span><span class="n">Random</span><span class="w"> </span><span class="kt">Number</span><span class="o">.</span><span class="w"> </span><span class="n">Returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">random</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">negative</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">numeric</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w"> </span><span class="n">Implemented</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">Java</span><span class="w"> </span><span class="n">Math</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="w"></span>
<span class="n">Package</span><span class="o">:</span><span class="w"> </span><span class="n">base</span><span class="o">.</span><span class="n">math</span><span class="w"></span>
</code></pre></div>
<p><code>describe_function</code> works both with the built-in as well with the
user-defined functions.  For the latter ones the function description
is the value of so called documentation strings - "docstrings".  if
the first expression in the function is a string literal it is
considered to be documentation string:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w">  </span><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">     </span><span class="s">&quot;Compute average of two numbers.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">   </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">37</span><span class="n">a71e93</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">describe_function</span><span class="p">(</span><span class="s">&quot;average&quot;</span><span class="p">)</span><span class="w"></span>

<span class="n">Arguments</span><span class="o">:</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="n">Documentation</span><span class="o">:</span><span class="w"> </span>
<span class="w">    </span><span class="n">Compute</span><span class="w"> </span><span class="n">average</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">numbers</span><span class="o">.</span><span class="w"></span>
<span class="n">Package</span><span class="o">:</span><span class="w"> </span><span class="n">user</span><span class="w"></span>
</code></pre></div>
<p>To get list of all the available function use <code>functions_names</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">functions_names</span><span class="p">()</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="o">%</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="p">,</span><span class="w"> </span><span class="o">-&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">-&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="o">.</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;=</span><span class="p">,</span><span class="w"> </span><span class="o">=</span><span class="p">,</span><span class="w"> </span><span class="o">==</span><span class="p">,</span><span class="w"> </span><span class="o">===</span><span class="p">,</span><span class="w"> </span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&gt;=</span><span class="p">,</span><span class="w"> </span><span class="nd">@-&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">AND</span><span class="p">,</span><span class="w"> </span><span class="n">APPEND</span><span class="w"> </span>
<span class="o">...</span><span class="w"></span>
</code></pre></div>
<h2 id="printing-values">Printing values</h2>
<p>So far we've only had things printed out implicitly as a result of
their evaluation. The standard way to print things out in the middle
of evaluation is with <code>print</code> or <code>println</code>. They take multiple
arguments and print them in order; <code>println</code> also prints a newline at
the end. Here's a variant of average that tells us what its arguments
were:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;my arguments were: &quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="s">&quot;, &quot;</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">);</span><span class="w"></span>
<span class="n">my</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">were</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="w"></span>


<span class="o">=&gt;</span><span class="w"> </span><span class="mi">300</span><span class="w"></span>
</code></pre></div>
<h2 id="return-value-of-the-function">Return Value of the Function</h2>
<p>From the previous example we see that when a function contains several
expressions the return value of the function is the value of the last
expression in the function. Previous expressions are evaluated 
and their value is discarded. </p>
<p>If you want to return value from function without reaching the last
expression use the <code>return</code> operator.</p>
<p>In the following example we define function that solves quadratic
equations. In the case when determinant is negative we print an error
message and exit prematurely returning an empty list.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">quadratic_eq_roots</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="s">&quot;Finds real roots of an quadratic equation&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">discriminant</span><span class="o">:=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">discriminant</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Error: the equation has no real solutions!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="w"> </span><span class="p">((</span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">((</span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">)];</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">quadratic_eq_roots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mf">2.732050807568877</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7320508075688772</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">quadratic_eq_roots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">equation</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">solutions!</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
</code></pre></div>
<h2 id="optional-and-vararg-arguments-for-functions">Optional and Vararg Arguments for Functions</h2>
<p>We've seen above some functions like <code>list</code> and <code>+</code> that take varying
numbers of arguments. Now we'll learn to define such functions.</p>
<p>Function parameters list can contain extra directives that specify how
the following parameters will be handled.</p>
<p>To make the parameters optional set its default value 
using the assignment <code>:=</code> operator.</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">NIL</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">str</span><span class="p">(</span><span class="s">&quot;hello &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mf">2e4</span><span class="n">b8173</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="s">&quot;Joe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!!!! :-)&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="n">Joe!!!!</span><span class="w"> </span><span class="o">:-</span><span class="p">)</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="s">&quot;Joe&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="n">Joe</span><span class="w"></span>
</code></pre></div>
<p>The expression for the default value does not have to be 
a constant. It can be any expression that can refer to values of 
preceding parameters:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">t1</span><span class="o">:=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">               </span><span class="n">t2</span><span class="o">:=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">t1</span><span class="o">==</span><span class="s">&quot;Mr.&quot;</span><span class="w"> </span><span class="s">&quot;, Sir&quot;</span><span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">t1</span><span class="o">==</span><span class="s">&quot;Mrs.&quot;</span><span class="w"> </span><span class="s">&quot;, Ma&#39;am&quot;</span><span class="w"> </span><span class="k">end</span><span class="p">;</span><span class="w"> </span><span class="k">end</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">str</span><span class="p">(</span><span class="s">&quot;Hello &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;! Nice to see you&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="s">&quot;Figman&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mrs.&quot;</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">Hello</span><span class="w"> </span><span class="n">Mrs</span><span class="o">.</span><span class="w"> </span><span class="n">Figman!</span><span class="w"> </span><span class="n">Nice</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">you</span><span class="p">,</span><span class="w"> </span><span class="n">Ma</span><span class="o">&#39;</span><span class="n">am!</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">greet</span><span class="p">(</span><span class="s">&quot;Alice&quot;</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">Hello</span><span class="w">  </span><span class="n">Alice!</span><span class="w"> </span><span class="n">Nice</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">you!</span><span class="w"></span>
</code></pre></div>
<p>Sometimes it is convenient to create functions that can take any number of arguments.
Such functions are often called "varargs - variable number of arguments" functions.
In Explang you can make such a function by following the last positional
argument by ellipsis:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="o">...</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">];</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mf">37f8</span><span class="n">bb67</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">]]</span><span class="w"></span>
</code></pre></div>
<p>To supply a list of arguments to a function we can use the apply function:</p>
<div class="highlight"><pre><span></span><code><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">];</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="sa">f</span><span class="s">&quot;+&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
</code></pre></div>
<p>Now that we have rest parameters and apply, we can write a version of
average that takes any number of arguments.</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="n">apply</span><span class="p">(</span><span class="sa">f</span><span class="s">&quot;+&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">args</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">3</span><span class="n">d646c37</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</code></pre></div>
<h2 id="keyword-arguments">Keyword arguments</h2>
<p>Keyword arguments are used when we want to pass a specific value to a
specific argument. Consider a scenario where there are 3 optional
arguments, what if the user wants to pass just a second optional
argument's value, here the first arguments even though is optional it
will be mandatory for him to pass its value making it a required
argument.</p>
<p>To solve this problem keyword arguments are used where the caller has
a choice to specify for argument values to which particular argument
they will be passed.</p>
<p>To define keyword arguments in a function, add ';' after defining the
positional arguments (if any). All the arguments after ';' will be
keyword arguments.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">keyword_example</span><span class="w"> </span><span class="p">(;</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">41</span><span class="n">cf53f9</span><span class="w"></span>
</code></pre></div>
<p>Keyword argument are passed as assignments of arguments and their values:</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="nv">keyword_example</span><span class="p">(</span><span class="nv">z:=3,</span><span class="w"> </span><span class="nv">x:=11,</span><span class="w"> </span><span class="nv">y:=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[11,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="nv">3]</span><span class="w"></span>
</code></pre></div>
<p>The keyword arguments are optional, you can call this function without 
setting all the arguments, the default argument value is <code>NIL</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">keyword_example</span><span class="p">();</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">keyword_example</span><span class="p">(</span><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">:=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>You can set default value of the keyword arguments just like with
optional positional arguments:</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="nv">keyword_example</span><span class="w"> </span><span class="p">(</span><span class="c1">; x:=1, y:=2, z:=x + y)</span><span class="w"></span>
<span class="w">    </span><span class="nv">[x,</span><span class="w"> </span><span class="nv">y,</span><span class="w"> </span><span class="nv">z]</span><span class="c1">;</span><span class="w"></span>
<span class="w">  </span><span class="nv">end</span><span class="c1">;</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">io.opsit.explang.Compiler$LAMBDA$1@2ef1e4fa</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">keyword_example</span><span class="p">()</span><span class="c1">;</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[1,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="nv">3]</span><span class="w"></span>
</code></pre></div>
<p>Very much like with the positional vararg functions you can allow functions
to get any number of keyword parameters in addition to those that are named
in the argument list. </p>
<p>In the following example the 'r' argument, which is marked with an ellipsis
is used to collect pairs of argument names (keywords) and their values.</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w">  </span><span class="nv">otherkeys_example</span><span class="w"> </span><span class="p">(</span><span class="nv">x</span><span class="w"> </span><span class="c1">; y, r...)</span><span class="w"></span>
<span class="w">    </span><span class="nv">[x,</span><span class="w"> </span><span class="nv">y,</span><span class="w"> </span><span class="nv">r]</span><span class="c1">;</span><span class="w"></span>
<span class="nv">end</span><span class="c1">;</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">io.opsit.explang.Compiler$LAMBDA$1@5cb0d902</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">otherkeys_example</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[1,</span><span class="w"> </span><span class="nv">null,</span><span class="w"> </span><span class="nv">[]]</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">otherkeys_example</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w">  </span><span class="nv">y:=2,</span><span class="w"> </span><span class="nv">p:=3,</span><span class="w"> </span><span class="nv">q:=4</span><span class="p">)</span><span class="c1">;</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">[1,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="nv">[:p,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="ss">:q,</span><span class="w"> </span><span class="nv">4]]</span><span class="w"></span>
</code></pre></div>
<h2 id="data-types-and-values">Data Types and Values</h2>
<p>Explang is a dynamically typed language.  There are no type
definitions in the language: each value carries its own type and 
those types are Java types.</p>
<p>The language can work with Java Objects of any type and it has
built-in support for standard data types such as Strings, Numbers,
Arrays, etc. </p>
<p>To get type of a value we use function <code>type_of</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="kt">String</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Double</span><span class="w"></span>
</code></pre></div>
<p>To check if object is of some specific type use the <code>typep</code> operator:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">typep</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;java.lang.String&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
</code></pre></div>
<p>Base Java type from the <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/package-frame.html"><code>java.lang</code></a>
can be specified without package:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">typep</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;String&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
</code></pre></div>
<p>The check returns true for the specific class as well as for class parents and the interfaces that it implements:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">typep</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;CharSequence&quot;</span><span class="p">)</span><span class="w">  </span><span class="c"># String implements CharSequence</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
</code></pre></div>
<p>The second arguments can be a string as well as symbol:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">typep</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Object&quot;</span><span class="p">)</span><span class="w">  </span><span class="c"># String implements CharSequence</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
</code></pre></div>
<p>The type of NIL is NIL.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">typep</span><span class="p">(</span><span class="n">NIL</span><span class="p">,</span><span class="w"> </span><span class="n">NIL</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<h2 id="nil-values">NIL values</h2>
<p>NIL represents absence of a useful value, it is implemented as Java <code>null</code>. 
It is not really a data type.</p>
<div class="highlight"><pre><span></span><code>type_of(NIL)

=&gt; NIL
</code></pre></div>
<h2 id="booleans">Booleans</h2>
<p>The Boolean type has two values, <code>false</code> and <code>true</code>. It is implemented using
as Java Boolean objects. </p>
<h2 id="numeric-types-and-values">Numeric Types And Values</h2>
<p>Explang works with Java numeric types. </p>
<p>Here table of types with examples of literals,</p>
<ul>
<li>1b, 0b  -- Byte </li>
<li>1s, 2s  -- Short (16 bit signed integer)</li>
<li>1, -2   -- Integer (32 bit signed integer)</li>
<li>1L  0L  -- Long literals (64 bit signed integer)</li>
<li>0.5f 1.2e-2f   -- Float literals (32 bit floating point)</li>
<li>0.5 1.2e-2 -- Double literals (64 bit floating point)</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="kt">Integer</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mi">1</span><span class="n">b</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Byte</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mf">0.1e4</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Double</span><span class="w"></span>
</code></pre></div>
<h2 id="numeric-types-promotions">Numeric Types Promotions</h2>
<p>When one performs arithmetic operations between different numeric types Explang 
performs automatic promotion of numeric types, i.e. the result of the operation 
will be of the type of the argument with highest precision. Operations between 
integer types and floating types are promoted to floating point types:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mi">1</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Short</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">type_of</span><span class="p">(</span><span class="mi">1</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="n">L</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">Double</span><span class="w"></span>
</code></pre></div>
<p>Note that Explang does not perform promotion for overflows between operations:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="n">s</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="n">s</span><span class="w">   </span><span class="c"># 100000 won&#39;t fit into 16 bit Short Integer,</span><span class="w"></span>
<span class="w">                 </span><span class="c"># so we&#39;ll get wrong result</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">-</span><span class="mi">31072</span><span class="w"></span>
</code></pre></div>
<h2 id="converting-to-numeric-types">Converting to Numeric Types</h2>
<p>The operators <code>byte</code>, <code>double</code>, <code>float</code>, <code>int</code>, <code>long</code>, <code>short</code> convert to corresponding
numeric types from other numeric types as well as from string representation:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">double</span><span class="p">(</span><span class="mi">1</span><span class="n">L</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mf">1.0</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">double</span><span class="p">(</span><span class="s">&quot;1E4&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mf">10000.0</span><span class="w"></span>
</code></pre></div>
<h2 id="strings">Strings</h2>
<p>Explang strings are Java Strings. Strings are constant, that is one cannot
change an existing string but have to create new one.</p>
<p>In code we can delimit literal strings by matching double quotes <code>"</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot; a line&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">line</span><span class="w"></span>
</code></pre></div>
<p>String literals  can have embedded newlines, tabs and any other characters except <code>"</code>: </p>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;line1</span>
<span class="s">line2</span>
<span class="s">line3&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">line1</span><span class="w"></span>
<span class="n">line2</span><span class="w"></span>
<span class="n">line3</span><span class="w"></span>
</code></pre></div>
To include a <code>"</code> one need to escape it using the  <code>\</code> escape character:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;quoted word </span><span class="se">\&quot;</span><span class="s">foo</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">quoted</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"></span>
</code></pre></div>
<p>There are other escape characters supported:</p>
<ul>
<li>\b - backspace 0x08</li>
<li>\t - tab 0x09</li>
<li>\n - newline 0x0a</li>
<li>\f - form feed 0x0c</li>
<li>\r - carriage return 0x0d</li>
</ul>
<p>Other characters when escaped will be inserted as they are:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\\</span><span class="s">t means tab &#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">\</span><span class="n">t</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">tab</span><span class="w"> </span><span class="err">&#39;</span><span class="w">   </span><span class="err">&#39;</span><span class="w"></span>
</code></pre></div>
<p>To convert any object into its string representation use 
the <code>string</code> operator:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="n">NIL</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<p>There are a couple of operators for building strings. The most general is
string, which takes any number of arguments and mushes them into a
string.</p>
<p>The most general is <code>str</code>, which takes any number of arguments and 
concatenates them into a string. Every argument will appear as it would 
look if printed out by pr, except nil, which is ignored.</p>
<div class="highlight"><pre><span></span><code>&gt; str(99, &quot; bottles of &quot;, :bee, &#39;r&#39;)

=&gt; &quot;99 bottles of beer&quot;
</code></pre></div>
<p>To control exactly the way the objects are converted to string use
the <code>format()</code> function, which converts its argument to string
using the first argument as format specification: </p>
<p><div class="highlight"><pre><span></span><code><span class="n">x</span><span class="o">:=</span><span class="mi">9786</span><span class="p">;</span><span class="w"></span>
<span class="n">format</span><span class="p">(</span><span class="s">&quot;Decimal: </span><span class="si">%d</span><span class="s">, hexadecimal: </span><span class="si">%x</span><span class="s">  octal: </span><span class="si">%o</span><span class="s">  char: </span><span class="si">%c</span><span class="s"> </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">Decimal</span><span class="o">:</span><span class="w"> </span><span class="mi">9786</span><span class="p">,</span><span class="w"> </span><span class="n">hexadecimal</span><span class="o">:</span><span class="w"> </span><span class="mi">263</span><span class="n">a</span><span class="w">  </span><span class="n">octal</span><span class="o">:</span><span class="w"> </span><span class="mi">23072</span><span class="w">  </span><span class="n">char</span><span class="o">:</span><span class="w"> </span><span class="n">☺</span><span class="w"></span>
</code></pre></div>
See <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html">java.util.Formatter</a>,
for details on building the format strings.</p>
<p><code>uppercase()</code> and <code>lowercase()</code> can be used to change case of a string:</p>
<p>Strings in Explang are considered a kind of indexed sequences
and can be operated upon using generic functions that work with sequences,
for example to get substring one should use <code>subseq()</code>, 
to get a specific character one uses subscript operator or accessor functions
like <code>get</code>, see below on how to work with sequences.</p>
<h2 id="string-interpolation">String Interpolation</h2>
<p>Constructing strings using the <code>format</code> function or string concatenation
may become cumbersome. To reduce need for these verbose calls and to allow
string representation in code be more similar to the program output Explang
allows string interpolation using the <code>$( expression )</code> syntax in 
string literals that are prefixed with flag <code>i</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w">   </span><span class="n">a</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">str</span><span class="o">:=</span><span class="sa">i</span><span class="s">&quot;</span><span class="si">$</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="s"> + </span><span class="si">$</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="s"> = </span><span class="si">$</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="s">&quot;</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
</code></pre></div>
<p>Note that string interpolation is strictly a syntax level feature: one cannot
build interpolated string dynamically at runtime (unless using <code>eval</code> to build
and evaluate the code). Another interesting property of string interpolation
is that one does not have to escape the double quotes in the interpolated
expressions, the following interpolated string literal may look strange, but
it is completely valid, note recursive use of interpolation inside the <code>if</code>
expression:</p>
<div class="highlight"><pre><span></span><code>&gt; result:=&quot;oops&quot;;

=&gt; oops
&gt; i&quot;Result: $(if result==&quot;ok&quot; &quot;Alright&quot; else i&quot;too bad: the value is $(result)&quot;; end)&quot;;

=&gt; Result: too bad: the value is oops
</code></pre></div>
<h2 id="character-type">Character Type</h2>
<p>Explang Characters represent Unicode 16-bit characters and implemented using Java 
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Character.html">java.lang.Character</a>.</p>
<p>Character literals are delimited using the 'c', '\UHEX','\uHEX' or '\ESCAPECHAR' notation:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;\u263a&#39;</span><span class="w"> </span><span class="p">];</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">,</span><span class="w"> </span>
<span class="p">,</span><span class="w"> </span><span class="n">☺</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>The <code>char</code> operator allows to create Characters from their numeric code:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">char</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
</code></pre></div>
<p>Characters can be used as operand of arithmetic expressions:</p>
<div class="highlight"><pre><span></span><code><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nb">+</span><span class="w"> </span><span class="ss">&#39;A</span><span class="o">&#39;</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">B</span><span class="w"></span>
</code></pre></div>
<h2 id="collection-and-sequence-types">Collection and Sequence types</h2>
<p>Explang attempts to provide operators that can be used 
on sequence and collection like objects of different types: 
lists, arrays, sets, hash maps and so on.</p>
<h3 id="lists">Lists</h3>
<p>Lists contains entries (objects or null) in slots that can be
addressed by their zero-based index. Lists do not have fixed size,
they grow/shrink dynamically when elements are added/removed.</p>
<p>The <code>list</code> operator creates and initializes a list. By default the
lists created are implemented by
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html">java.util.ArrayList</a>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span><span class="w"></span>

<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]]</span><span class="w"></span>
</code></pre></div>
<p>Call to <code>list()</code> may be abbreviated using the '[ ]' syntax:</p>
<div class="highlight"><pre><span></span><code>&gt; [1, 2, [3, 4]]

=&gt; [1, 2, [3, 4]]
</code></pre></div>
<h3 id="maps">Maps</h3>
<p>Use the <code>hashmap</code> to create and initialize a Map 
(implemented by <a href="https://docs.oracle.com/javase/8/docs/api/java/util/HashMap.html">java.util.HashMap</a>).</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">hashmap</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hashmap</span><span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;e&quot;</span><span class="p">))</span><span class="w"></span>

<span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kt">b</span><span class="o">=</span><span class="kt">foo</span><span class="p">,</span><span class="w"> </span><span class="kt">c</span><span class="o">=</span><span class="p">{</span><span class="kt">d</span><span class="o">=</span><span class="kt">e</span><span class="p">}}</span><span class="w"></span>
</code></pre></div>
<p>Call to <code>hashmap()</code> may be abbreviated using the '{}' syntax:</p>
<div class="highlight"><pre><span></span><code>&gt; { &quot;a&quot; : 1, &quot;b&quot; : &quot;foo&quot;,  &quot;c&quot; : { &quot;d&quot; : &quot;e&quot;}}

=&gt; {a=1, b=foo, c={d=e}}
</code></pre></div>
<p>Note, that [] and {} syntaxes together allow to initialize data structures using
a JSON compatible notation.</p>
<h3 id="sets">Sets</h3>
<p>A Set is a collection that contains no duplicate elements. More
formally, sets contain no pair of elements e1 and e2 such that <code>e1 == e2</code>
would return true. </p>
<p>As implied by its name, this type models the mathematical set
abstraction.</p>
<p>The <code>hashset</code> operator creates a set and initializes it with the specified elements:</p>
<div class="highlight"><pre><span></span><code><span class="n">hashset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">hashset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">NIL</span><span class="p">,</span><span class="w"> </span><span class="n">NIL</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]]</span><span class="w"></span>
</code></pre></div>
<h3 id="arrays">Arrays</h3>
<p>Arrays are areas of memory that contain entries in slots that can be
addressed by their zero-based index.  Arrays have fixed size that
determined at their creation time. Unlike lists arrays are created 
to contain objects or primitive values of given type.</p>
<p>The <code>make_array</code> operator creates array and initializes it with 
specified elements. </p>
<p>By defaults <code>make_array</code> creates array of type Object that can contain any java object.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;123&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">NIL</span><span class="p">)</span><span class="w"> </span><span class="c"># array with specified objects</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">null</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">make_array</span><span class="p">(</span><span class="n">size</span><span class="o">:=</span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="c"># array of specified size </span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">null</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">make_array</span><span class="p">(</span><span class="n">size</span><span class="o">:=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">elementType</span><span class="o">:=</span><span class="s">&quot;double&quot;</span><span class="p">)</span><span class="w"> </span><span class="c"># array for storing primitive double values</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">make_array</span><span class="p">(</span><span class="n">size</span><span class="o">:=</span><span class="mi">10</span><span class="p">,</span><span class="w">                </span><span class="p">;</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span>
<span class="w">             </span><span class="n">elementType</span><span class="o">:=</span><span class="s">&quot;char&quot;</span><span class="p">,</span><span class="w">     </span><span class="p">;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">storing</span><span class="w"> </span><span class="n">primitive</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">values</span><span class="w"></span>
<span class="w">             </span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;O&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="n">partially</span><span class="w"> </span><span class="n">filled</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">O</span><span class="p">,</span><span class="w"> </span><span class="err"> </span><span class="p">,</span><span class="w"> </span><span class="err"> </span><span class="p">,</span><span class="w"> </span><span class="err"> </span><span class="p">,</span><span class="w"> </span><span class="err"> </span><span class="p">,</span><span class="w"> </span><span class="err"> </span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="character-sequences">Character Sequences</h3>
<p>Regular string objects that we've seen earlier is one of the types that 
are called Character Sequences. In Java these objects 
implement interface
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/CharSequence.html">java.lang.CharSequence</a>).</p>
<p>There are other such types that, unlike strings, can be modified in place:</p>
<p>The <code>string_buffer</code> function creates a 
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuffer.html"><code>StringBuffer</code></a> object:</p>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">string_buffer</span><span class="p">()</span><span class="w"> </span><span class="c"># creates empty StringBuffer</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">string_buffer</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="p">)</span><span class="w">  </span><span class="c"># create stringbuffer with text</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;foobar&quot;</span><span class="w"></span>
</code></pre></div>
The <code>string_builder</code> function creates a 
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html"><code>StringBuilder</code></a> object.
<code>StringBuilder</code> is similar to <code>StringBuffer</code>, but unlike <code>StringBuffer</code> it can be safely 
modified from different threads.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">string_builder</span><span class="p">()</span><span class="w"> </span><span class="p">;;</span><span class="w"> </span><span class="n">creates</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">StringBuilder</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">string_builder</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="p">)</span><span class="w">  </span><span class="p">;;</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">stringbuilder</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">text</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;foobar&quot;</span><span class="w"></span>
</code></pre></div>
<p>In the following chapters we'll learn to operate on data in sequence types.</p>
<h2 id="getting-information-about-collections-and-sequences">Getting Information About Collections and Sequences</h2>
<p>The function <code>length()</code> returns length of a collection or sequence:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">length</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">hashmap</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">hashset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">))]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>The collection predicates return <code>true</code> or <code>false</code> allow to check if an objects have some 
property or ability. By convention their name ends by <em>p</em> - predicate.</p>
<p><code>collp</code> returns true if the object is a collection of some kind, for example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="nv">[</span><span class="w"> </span><span class="nv">collp</span><span class="p">(</span><span class="nv">[]</span><span class="p">)</span><span class="o">,</span><span class="w"></span>
<span class="w">    </span><span class="nv">collp</span><span class="p">(</span><span class="nb">make-array</span><span class="p">())</span><span class="o">,</span><span class="w"> </span>
<span class="w">    </span><span class="nv">collp</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="o">,</span><span class="w">         </span><span class="c1">; string is a CharSequence</span><span class="w"></span>
<span class="w">    </span><span class="nv">collp</span><span class="p">(</span><span class="nv">range</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="p">))</span><span class="o">,</span><span class="w"></span>
<span class="w">    </span><span class="nv">collp</span><span class="p">(</span><span class="no">nil</span><span class="p">)</span><span class="o">,</span><span class="w">           </span><span class="c1">;; non-object </span><span class="w"></span>
<span class="w">    </span><span class="nv">collp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nv">]</span><span class="w">             </span><span class="c1">;; individual object</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[true,</span><span class="w"> </span><span class="nv">true,</span><span class="w"> </span><span class="nv">true,</span><span class="w"> </span><span class="nv">true,</span><span class="w"> </span><span class="nv">false,</span><span class="w"> </span><span class="nv">false]</span><span class="w"></span>
</code></pre></div>
<p><code>seqp</code> returns true if the object is a sequence, that is collection with specific order.</p>
<p><code>indexedp</code> returns true if objects in the collection can be addressed by integer index.</p>
<p><code>mapp</code> returns true if it is a Map.</p>
<p><code>setp</code> returns true if the object is a Set.</p>
<p><code>associativep</code> returns true if objects in collection are indexed or have keys.</p>
<h3 id="in-check-if-a-collection-contains-an-object"><code>in</code> check if a collection contains an object.</h3>
<p>The <code>in</code> operator checks if a collection contains an object. </p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">hashset</span><span class="p">(</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="s">&quot;baz&quot;</span><span class="o">,</span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">true</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">range</span><span class="p">(</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">false</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="ss">&#39;e</span><span class="o">&#39;</span><span class="w"> </span><span class="nv">in</span><span class="w">  </span><span class="s">&quot;Hi there!&quot;</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">true</span><span class="w"></span>
</code></pre></div>
<h2 id="accessing-data-in-collections-and-objects">Accessing data in collections and Objects</h2>
<p>Explang attempts to provide generic data access operators that can be used on
all kinds of sequences, collections and objects like lists, arrays, sets, hash
maps, java beans and so on.</p>
<h3 id="the-subscript-operator-k">The Subscript Operator <code>[k]</code></h3>
<p>The subscript operator with key/index <code>[k]</code> allows to fetch nested
objects by keys or indices.</p>
<p>The subscript may be any expression, the evaluation result will be used as  key
(in case of Map or Java Bean) or index (in case of Lists, arrays, and other sequences). </p>
<p>Let's define a data structure that we'll use in our examples:</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">::=</span><span class="p">{</span><span class="w"> </span><span class="s">&quot;people&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                           </span><span class="s">&quot;relatives&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;motherId&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="s">&quot;fatherId&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;friendIds&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">]},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Jack&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Ann&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Roe&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Bill&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Moe&quot;</span><span class="p">}}};</span><span class="w"></span>

<span class="p">{</span><span class="kt">people</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">]</span><span class="w"></span>

<span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">}}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;name&quot;</span><span class="p">]</span><span class="w"></span>

<span class="n">John</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;friendIds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
</code></pre></div>
<p>When provided an invalid index <code>[k]</code> returns NIL:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;friendIds&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<p>It means that it is not possible to know from the return value if an
element is missing or it is a NIL element.</p>
<p>When this is important one can use the <code>get</code> function, which
works like <code>[k]</code>,but accepts an optional third argument -- default value. 
If index is invalid or key is missing it will return the value of the
third argument:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">get</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;friendIds&quot;</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;No such index&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">index</span><span class="w"></span>
</code></pre></div>
<h3 id="the-dot-operator">The <code>.</code> (dot) operator</h3>
<p>The <code>.</code> (dot) operator as well as [k] allows to look up nested
objects, but it works somewhat differently:</p>
<ul>
<li>The keys are constant: they are not evaluated at runtime,</li>
<li>It does not support keys that are not valid symbols: they must start
  with a letter or with<code>_</code> and can contain only alphanumeric
  characters, <code>_</code> and <code>!</code>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">friendIds</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">surname</span><span class="o">.</span><span class="n">bytes</span><span class="w">  </span><span class="c"># gets array of bytes from  String.getBytes()</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">68</span><span class="p">,</span><span class="w"> </span><span class="mi">111</span><span class="p">,</span><span class="w"> </span><span class="mi">101</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="empty-subscript">Empty subscript <code>[]</code></h3>
<p>When there is no index specified the operator works as an iterator,
that is it applies all the following subscript operations on all the values
in the collection:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[]</span><span class="w">   </span><span class="c"># return list off map entries</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">}]</span><span class="w"></span>


<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[][</span><span class="s">&quot;key&quot;</span><span class="p">]</span><span class="w">  </span><span class="c"># returns list of map keys</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[][</span><span class="s">&quot;value&quot;</span><span class="p">]</span><span class="w">  </span><span class="c"># returns list of map values</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">}]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">[][</span><span class="s">&quot;value&quot;</span><span class="p">][</span><span class="s">&quot;name&quot;</span><span class="p">]</span><span class="w"></span>

<span class="p">[</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="n">Jack</span><span class="p">,</span><span class="w"> </span><span class="n">Ann</span><span class="p">,</span><span class="w"> </span><span class="n">Bill</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="get_in-function-access-values-in-nested-structures"><code>get_in</code> function access values in nested structures</h3>
<p><code>get_in</code> performs data retrieval like a chain of <code>[k]</code> operators, but 
list of keys is provided as a list that can be set dynamically at runtime.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">get_in</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;relatives&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;motherId&quot;</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
</code></pre></div>
<p>When there is no mapping get-in returns NIL.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">get_in</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;relatives&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;brothersIds&quot;</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<p><code>get_in</code> also allows to specify default for missing keys/indices:</p>
<div class="highlight"><pre><span></span><code>&gt; get_in(data, [&quot;people&quot;,1,&quot;relatives&quot;, &quot;brothersIds&quot;], &quot;N/A&quot;)

=&gt; N/A
</code></pre></div>
<h3 id="fields-operator"><code>fields</code> operator</h3>
<p>The fields operator allows to select a subset of keys 
from a map or from list/array entries:</p>
<div class="highlight"><pre><span></span><code>&gt; data.people[][&quot;value&quot;]  fields name, surname

[{name=John, surname=Doe}, {surname=Doe, name=Jack}, {surname=Roe, name=Ann}, {name=Bill, surname=Moe}]

&gt; data.people[1] | fields name, surname

=&gt; {surname=Doe, name=John}
</code></pre></div>
<h3 id="select_keys-function-select-entries-by-their-keysindices"><code>select_keys</code> function select entries by their keys/indices</h3>
<p>Returns map of  entries selected  by their keys/indices</p>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">select_keys</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">people</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
The returned Map is actually kind of a view into the original object, 
that is it reflects changes in the original:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="o">:=</span><span class="p">{</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kt">b</span><span class="o">=</span><span class="mi">2</span><span class="p">}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">s</span><span class="o">:=</span><span class="n">select_keys</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">))</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">a</span><span class="o">=</span><span class="mi">1</span><span class="p">}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w">  </span><span class="n">m</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">]</span><span class="o">:=</span><span class="s">&quot;3&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">m</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kt">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="kt">c</span><span class="o">=</span><span class="mi">3</span><span class="p">}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">s</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="kt">c</span><span class="o">=</span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="c"># now s got new entry c=3</span><span class="w"></span>
</code></pre></div>
<h3 id="first"><code>first</code></h3>
<p><code>first</code> return first object in collection</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">first</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</code></pre></div>
<h3 id="rest-take-and-subseq"><code>rest</code>, <code>take</code> and <code>subseq</code></h3>
<p><code>rest</code> returns the subsequence starting from the second element.</p>
<p><code>take</code> returns first n elements of the sequence.</p>
<p><code>subseq</code> returns a subsequence from the given index or between the first given index and up to the second given index (excluding):</p>
<div class="highlight"><pre><span></span><code>&gt; a:=[1,2,3,4,5,6]

=&gt; [1, 2, 3, 4, 5, 6]

&gt; first(a)

=&gt; 1

&gt; rest(a)

=&gt; [2, 3, 4, 5, 6]

&gt; subseq(a,1)

&gt; [2, 3, 4, 5, 6]
</code></pre></div>
<p>The <code>take</code> and <code>subseq</code> return sequence of the same kind as the source
sequence.  The type of the returned sequence differs depending on the
type of the source sequence.  For lists it returns a sublist, which is
sharing the elements with the source list.  For arrays this is not
possible and the data is copied into new array.</p>
<div class="highlight"><pre><span></span><code>b:=subseq(a,1,3)

=&gt; [2, 3]

&gt; a[1]:=8

=&gt; 8

&gt; b

=&gt; [8, 3]
</code></pre></div>
<h3 id="haskey"><code>haskey</code></h3>
<p><code>haskey</code> checks if a Map has given key or if an indexed sequence has specified index.
Unlike <code>get</code> and <code>in</code> this allows to check whether a map contains NIL as a key.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">M</span><span class="o">:=</span><span class="p">{</span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">  </span><span class="kt">NIL</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kt">NIL</span><span class="p">}</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">null</span><span class="o">=</span><span class="kt">null</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="p">}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">haskey</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">haskey</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">NIL</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">haskey</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>
</code></pre></div>
<h2 id="destructuring-of-data-structures">Destructuring of Data Structures</h2>
<p>Destructuring allows to easily fetch data elements from data
structures and assign them to variables without fetching them
individually using functions like <code>get</code> or <code>get-in</code>.</p>
<p>The idea is to provide on the receiving end of the assignment operator
a sort of template for the data structure with the desired names of variables.</p>
<h3 id="destructuring-of-sequences">Destructuring of sequences</h3>
<p>Suppose we have a function that returns a vector with three values that represent coordinates:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">getpos</span><span class="p">()</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span><span class="w"> </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">7</span><span class="n">b49cea0</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getpos</span><span class="p">();</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>We could access individual coordinates using subscripts like <code>pos[0]</code>, but
this is kind of cumbersome and not very readable. We could also assign
individual values to variables <code>x</code>,<code>y</code>,<code>z</code> using assignments, but
destructuring allows to do it in one easy statement:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getpos</span><span class="p">();</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="s">&quot;x=</span><span class="si">%d</span><span class="s">, y=</span><span class="si">%d</span><span class="s">, z=</span><span class="si">%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="o">=</span><span class="mi">3</span><span class="w"></span>
</code></pre></div>
<p>When there are more elements in the source sequence than in the target template, the rest of the 
values are ignored. So if we were interested only in the first coordinate we could write:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getpos</span><span class="p">();</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
</code></pre></div>
<p>One can use same symbol several times in the template, the name will
end up bound to the last value. For example, if we were interested
only in the last coordinate we could write:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getpos</span><span class="p">();</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">z</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">_</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
</code></pre></div>
<p>By convention a single underscore is used for variables that we
have to use, but do not care about their value.</p>
<p>Destructuring works for various kinds of sequences, not just lists:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">&quot;CHARS&quot;</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">CHARS</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="destructuring-of-nested-sequences">Destructuring of Nested Sequences</h3>
<p>Instead of being a symbol an element of the template can be a 
nested list. In this case the destructuring will proceed 
recursively:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">val</span><span class="o">:=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="mi">5</span><span class="p">];</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">],</span><span class="w"> </span><span class="n">e</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="destructuring-of-maps">Destructuring of Maps</h3>
<p>Destructuring also works for Maps. The idea is the same as with
sequences: you provide a template for the map: a structure that
includes the symbols that you want to bind to values in the map and
the keys of those values.</p>
<p>Suppose we have this simple map with personal data:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;age&quot;</span><span class="w">     </span><span class="o">:</span><span class="w">  </span><span class="mi">44</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">age</span><span class="o">=</span><span class="mi">44</span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>To extract name and surname from the above record we 
provide map with variable symbols as keys and keys of the source 
map as symbols:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;surname&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">age</span><span class="o">=</span><span class="mi">44</span><span class="p">}</span><span class="w"></span>

<span class="n">format</span><span class="p">(</span><span class="s">&quot;name=</span><span class="si">%s</span><span class="s">, surname=</span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">surname</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="n">John</span><span class="p">,</span><span class="w"> </span><span class="n">surname</span><span class="o">=</span><span class="n">Doe</span><span class="w"></span>
</code></pre></div>
<p>One can destructure nested structures as well. Let's add a nested map and a nested 
list to the above data structure:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;age&quot;</span><span class="w">     </span><span class="o">:</span><span class="w">  </span><span class="mi">44</span><span class="w"> </span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;parents&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;mother&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Mary Doe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;father&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Richard Doe&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"></span>
<span class="w">             </span><span class="s">&quot;brothers&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s">&quot;jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;harry&quot;</span><span class="p">]};</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">brothers</span><span class="o">=</span><span class="p">[</span><span class="kt">jack</span><span class="p">,</span><span class="w"> </span><span class="kt">harry</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">age</span><span class="o">=</span><span class="mi">44</span><span class="p">,</span><span class="w"> </span><span class="kt">parents</span><span class="o">=</span><span class="p">{</span><span class="kt">mother</span><span class="o">=</span><span class="kt">Mary</span><span class="w"> </span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">father</span><span class="o">=</span><span class="kt">Richard</span><span class="w"> </span><span class="kt">Doe</span><span class="p">}}</span><span class="w"></span>
</code></pre></div>
<p>To extract names of parents we use a submap as a key of the left-side map in place of a symbol
to destructure the nested map:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kt">mom</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;mother&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">dad</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;father&quot;</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;parents&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">brothers</span><span class="o">=</span><span class="p">[</span><span class="kt">jack</span><span class="p">,</span><span class="w"> </span><span class="kt">harry</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">age</span><span class="o">=</span><span class="mi">44</span><span class="p">,</span><span class="w"> </span><span class="kt">parents</span><span class="o">=</span><span class="p">{</span><span class="kt">mother</span><span class="o">=</span><span class="kt">Mary</span><span class="w"> </span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">father</span><span class="o">=</span><span class="kt">Richard</span><span class="w"> </span><span class="kt">Doe</span><span class="p">}}</span><span class="w"></span>


<span class="o">&gt;</span><span class="w"> </span><span class="n">format</span><span class="p">(</span><span class="s">&quot;mom=</span><span class="si">%s</span><span class="s">, dad=</span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mom</span><span class="p">,</span><span class="w"> </span><span class="n">dad</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">mom</span><span class="o">=</span><span class="n">Mary</span><span class="w"> </span><span class="n">Doe</span><span class="p">,</span><span class="w"> </span><span class="n">dad</span><span class="o">=</span><span class="n">Richard</span><span class="w"> </span><span class="n">Doe</span><span class="w"></span>
</code></pre></div>
<p>To extract names of both brothers:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="kt">brother1</span><span class="p">,</span><span class="w"> </span><span class="kt">brother2</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;brothers&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">entry</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">brothers</span><span class="o">=</span><span class="p">[</span><span class="kt">jack</span><span class="p">,</span><span class="w"> </span><span class="kt">harry</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">age</span><span class="o">=</span><span class="mi">44</span><span class="p">,</span><span class="w"> </span><span class="kt">parents</span><span class="o">=</span><span class="p">{</span><span class="kt">mother</span><span class="o">=</span><span class="kt">Mary</span><span class="w"> </span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">father</span><span class="o">=</span><span class="kt">Richard</span><span class="w"> </span><span class="kt">Doe</span><span class="p">}}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">brother1</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">jack</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">brother2</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">harry</span><span class="w"></span>
</code></pre></div>
<h2 id="modifying-data-in-collections">Modifying data in collections</h2>
<p>There are two kinds of functions that modify data in collections:
those that change the data in place (mutating) and those that return
new data structures with requested changes. By convention the former
ones have names that end with exclamation mark.</p>
<h3 id="put-put-element-value-into-an-associative-structure"><code>put!</code> - put element value into an associative structure.</h3>
<p>Set value of element at index/key in the target structure to object. </p>
<p>If target object is a list or an array and an out of bound exception happens
the function returns normally without any change to the target structure</p>
<p>This function returns previous value of the element or NIL if id did not exist
or no change has been made."</p>
<p>Example with a Map:</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="nv">m:={</span><span class="s">&quot;foo&quot;</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">}</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">{foo=1}</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">put!</span><span class="p">(</span><span class="nv">m,</span><span class="s">&quot;bar&quot;</span><span class="o">,</span><span class="mi">77</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="no">NIL</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">put!</span><span class="p">(</span><span class="nv">m,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="o">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">m</span><span class="w"></span>

<span class="nv">{bar=77,</span><span class="w"> </span><span class="nv">foo=0}</span><span class="w"></span>
</code></pre></div>
<p>Example with an array of integer numbers:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">:=</span><span class="n">make_array</span><span class="p">(</span><span class="n">size</span><span class="o">:=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">elementType</span><span class="o">:=</span><span class="s">&quot;int&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">put!</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="using-the-assignment-operator-to-modify-data-structures">Using the assignment operator to modify data structures.</h3>
<p>Let's add some friends to John using the same structure 
from the <code>get-in</code> example above:</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">::=</span><span class="p">{</span><span class="w"> </span><span class="s">&quot;people&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">      </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w">   </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                           </span><span class="s">&quot;relatives&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;motherId&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"></span>
<span class="w">                                          </span><span class="s">&quot;fatherId&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;friendIds&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">]},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Jack&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Doe&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">3</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Ann&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Roe&quot;</span><span class="p">},</span><span class="w"></span>
<span class="w">                     </span><span class="mi">4</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Bill&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                           </span><span class="s">&quot;surname&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Moe&quot;</span><span class="p">}}};</span><span class="w"></span>

<span class="p">{</span><span class="kt">people</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
<p>Use of the subscript [k] and <code>.</code> operators is supported on the left side of the assignment:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">:=</span><span class="p">{</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Rick&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;surname&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Hoe&quot;</span><span class="p">}</span><span class="w"> </span><span class="c"># add new person to map with index 5</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Hoe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Rick</span><span class="p">}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&quot;friendIds&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="c"># add id of the newly added person</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">people</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">},</span><span class="w"> </span><span class="mi">5</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Hoe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Rick</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
<h3 id="the-put_in-modify-value-in-a-hierarchy-of-nested-associative-structures">the put_in! modify value in a hierarchy of nested associative structures.</h3>
<p>The <code>put_in!</code> function performs data modification like the assignment
operator on a chain of <code>[k]</code> and <code>.</code> operators. It accepts a list of
keys that allows to navigate dynamically in nested associative
structures. <code>put_in!</code> return the modified data structure.</p>
<p>The same operation as above using <code>put_in!</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">put_in!</span><span class="p">(</span><span class="n">data</span><span class="p">,[</span><span class="s">&quot;people&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Rick&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;surname&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Hoe&quot;</span><span class="p">})</span><span class="w"> </span><span class="c"># add new person to map</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">people</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">},</span><span class="w"> </span><span class="mi">5</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Hoe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Rick</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
<p>In addition <code>put_in!</code> accepts one optional argument that allows to
specify how to automatically create structures along the path in case
they do not exist. For example this will add Rick Row (id=5) as a
friend to Bill that does not have a list of friend identifiers.
<code>put-in</code> would copy the provided object (an empty list) to create list
of <code>friendIds</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">put_in!</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;people&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s">&quot;friendIds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">[])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="kt">people</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">John</span><span class="p">,</span><span class="w"> </span><span class="kt">relatives</span><span class="o">=</span><span class="p">{</span><span class="kt">motherId</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="kt">fatherId</span><span class="o">=</span><span class="mi">2</span><span class="p">}},</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Doe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Jack</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Roe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Ann</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="p">{</span><span class="kt">friendIds</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="kt">surname</span><span class="o">=</span><span class="kt">Moe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Bill</span><span class="p">},</span><span class="w"> </span><span class="mi">5</span><span class="o">=</span><span class="p">{</span><span class="kt">surname</span><span class="o">=</span><span class="kt">Hoe</span><span class="p">,</span><span class="w"> </span><span class="kt">name</span><span class="o">=</span><span class="kt">Rick</span><span class="p">}}}</span><span class="w"></span>
</code></pre></div>
<h3 id="delete">delete!</h3>
<p>Removes an object from a collection according to its key or index. 
For sets it will remove the object by its value.</p>
<div class="highlight"><pre><span></span><code>L:=[1, 2, 3]

=&gt; [1, 2, 3]

&gt; delete!(L, 1)

=&gt; 2

&gt; L

=&gt; [1, 3]
</code></pre></div>
<h3 id="insert-push-and-pop"><code>insert!</code>, <code>push!</code> and <code>pop!</code></h3>
<p>These functions work for lists and mutable character sequences. </p>
<p><code>insert!</code> inserts an object at given index:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">insert!</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;X&quot;</span><span class="p">)</span><span class="w"></span>

<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p><code>push!</code> will add an object to the end of a sequence, <code>pop!</code> will
remove and return the object at the end of the sequence.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="o">:=</span><span class="p">[]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">push!</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">foo</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">push!</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">bar</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">pop!</span><span class="p">(</span><span class="n">stack</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">foo</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="append">APPEND!</h3>
<p><code>append!</code> adds to the target sequence all the elements of all of the following sequences.
It will return the target sequence. For example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">append!</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">],</span><span class="w">  </span><span class="n">make_array</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;HELLO!&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">O</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>Target sequence must be mutable extendable, that means that objects 
like Arrays (non-extendable) or String (immutable) cannot be target of this operation.</p>
<h3 id="reverse"><code>reverse!</code></h3>
<p><code>reverse!</code> Reverses the order of elements in the given sequence:</p>
<div class="highlight"><pre><span></span><code><span class="nb">&gt;</span><span class="w"> </span><span class="nv">L:=[1,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="nv">6]</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[1,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="nv">6]</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">reverse!</span><span class="p">(</span><span class="nv">L</span><span class="p">)</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[6,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="nv">1]</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">reverse!</span><span class="p">(</span><span class="nb">subseq</span><span class="p">(</span><span class="nv">L,1,4</span><span class="p">))</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[3,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="nv">5]</span><span class="w"></span>

<span class="nb">&gt;</span><span class="w"> </span><span class="nv">L</span><span class="w"></span>

<span class="nv">=&gt;</span><span class="w"> </span><span class="nv">[6,</span><span class="w"> </span><span class="mi">3</span><span class="o">,</span><span class="w"> </span><span class="mi">4</span><span class="o">,</span><span class="w"> </span><span class="mi">5</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="nv">1]</span><span class="w"></span>
</code></pre></div>
<h3 id="sort-sort-a-sequence"><code>sort!</code> sort a sequence.</h3>
<p><code>sort!</code> will sort a sequence. It can sort 
according to the natural order of its objects (if they implement 
<code>java.lang.Comparable</code>) or using a user specified compare function.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="w"> </span><span class="n">make_array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">sort!</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>Sort according to length of sequences with a custom compare function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[[],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[[],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">sort!</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="n">L</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[[],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[[],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">]]</span><span class="w"></span>
</code></pre></div>
<h2 id="collection-specific-access-functions">Collection Specific Access functions</h2>
<p>In addition to the generic data access functions there are 
data access functions that are specific for concrete collection types.</p>
<h3 id="aref-and-aset-array-member-access"><code>aref</code> and <code>aset!</code> -- array member access.</h3>
<p>Unlike <code>put!</code> and <code>get</code> they will fail with exception when index is invalid. </p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">aset!</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"></span>
</code></pre></div>
<h3 id="assoc">assoc!</h3>
<p>Adds one or more mappings to a Map:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">M</span><span class="o">:=</span><span class="p">{}</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">assoc!</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="o">=</span><span class="mi">6</span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h2 id="modifying-data-with-non-mutating-functions">Modifying data with non-mutating functions</h2>
<p>The mutating functions that were described above have non-mutating
counterparts that have same names without the '!' suffixes, accept
same arguments and, instead of modifying target objects, 
return new object with required modifications 
leaving the original objects unmodified.</p>
<p>For example <code>append</code> concatenates its argument into new sequence:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="w">  </span><span class="c"># not changed</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span>
</code></pre></div>
<p>The returned sequence is of the same kind as the first function argument, so this 
construction may be used to convert collection into other collection types:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="n">hashset</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w">  </span><span class="p">;;</span><span class="w"> </span><span class="n">convert</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
</code></pre></div>
<p>List of non-mutating functions for data modification:</p>
<p><code>append</code>, <code>aset</code>, <code>assoc</code>, <code>insert</code>, <code>push</code>, <code>pop</code>, <code>put</code>, <code>put-in</code>, <code>delete</code>, <code>reverse</code>,
<code>sort</code></p>
<h3 id="put">put</h3>
<h2 id="searching-and-matching-text-data-using-regular-expressions">Searching and Matching Text Data Using Regular Expressions</h2>
<p>Regular expression (regex) support in Explang is implemented using the
Java regular expression engine.</p>
<p>This guide assumes that you have general understanding of what the
regular expressions are and how to use them.  There are good resources
for learning about regular expressions and trying them online,
for example <a href="https://regex101.com">Regex 101</a>.
The reference documentation for Java regex syntax is here:
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html">java.util.regex.Pattern</a>.</p>
<h3 id="creating-regex-patterns">Creating Regex Patterns</h3>
<p>In Explang you can create a regex using a literal syntax. 
Strings with a '#' in front are interpreted as regexes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="sa">r</span><span class="sr">&quot;^Hello$&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">^</span><span class="n">Hello</span><span class="o">$</span><span class="w"></span>
</code></pre></div>
<p>This will create and instance of <code>java.util.regex.Pattern</code> that can be 
immediately used for matching a text or saved for later use.</p>
<p>Alternatively you can create regexes from string using the <code>re-pattern</code>
function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">re_pattern</span><span class="p">(</span><span class="s">&quot;^Hello$&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">^</span><span class="n">Hello</span><span class="o">$</span><span class="w"></span>
</code></pre></div>
<p>The literal syntax is the most convenient because you don't need to
double escape regexp special characters. For example, if you want to
represent the regex string to match a digit, using a string
you would need to write this:</p>
<p>For example, if you want to represent the regex string to match a
digit, using a string you would need to write this:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">re_pattern</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">d&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">\</span><span class="n">d</span><span class="w"></span>
</code></pre></div>
<p>Notice that you have to escape the backslash to get a literal
backslash in the string. However with literals you do not need to
double escape:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="sa">r</span><span class="sr">&quot;</span><span class="err">\</span><span class="sr">d&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">\</span><span class="n">d</span><span class="w"></span>
</code></pre></div>
<p>On the other hand, the <code>re_pattern</code> function is good when you have to
build regexes dynamically or get them from some external source.</p>
<h3 id="the-globbing-patterns">The Globbing Patterns</h3>
<p>Globbing patterns are commonly used to specify sets of filenames with
wildcard characters. </p>
<ul>
<li><code>*</code> a wildcard standing for any string of characters</li>
<li><code>?</code> a wildcard that stands for one character</li>
</ul>
<p>For example <code>a*.txt</code> is a glob pattern that would match 
names of files with <code>.txt</code> extension.</p>
<p>Explang supports globbing patterns by internally converting them to
regex patterns. One can use the produced pattern just like 
regular regex patterns.</p>
<p>You can create globbing patterns using  a literal syntax,
Strings with a <code>#g</code> in front are interpreted as regexes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="sa">g</span><span class="s">&quot;a*.txt&quot;</span><span class="w"></span>

<span class="o">==&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">.*\.</span><span class="n">txt</span><span class="w"></span>
</code></pre></div>
<p>Alternatively you can create globbing patterns 
from strings using the <code>re_glob</code> function:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">re_glob</span><span class="w"> </span><span class="s">&quot;a*.txt&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="o">.*\.</span><span class="n">txt</span><span class="w"></span>
</code></pre></div>
<h3 id="creating-a-case-insensitive-regex-and-other-flags">Creating a Case Insensitive Regex (and other flags)</h3>
<p>The Java regex engine allows to supply extra flags when creating
regexp pattern.  The most commonly used flag is <code>i</code> - case insensitive
matching.</p>
<p>Java regexes allow for a special syntax (embedded flags expression) to
enable flags within the regex.</p>
<p>no flags (case-sensitive):
<div class="highlight"><pre><span></span><code>&gt; re_matches(r&quot;abc&quot;,&quot;ABC&quot;)

=&gt; NIL
</code></pre></div></p>
<p>case-insensitive flag set</p>
<div class="highlight"><pre><span></span><code>&gt; re_matches(r&quot;(?i)abc&quot;, &quot;ABC&quot;)

=&gt; ABC
</code></pre></div>
<p>Explang regex literals support specifying flags after the expression:</p>
<div class="highlight"><pre><span></span><code>&gt; re_matches(r&quot;abc&quot;i, &quot;ABC&quot;)

=&gt; ABC
</code></pre></div>
<p>The <code>re-pattern</code> and <code>re-glob</code> functions accept an optional string
argument that contains string of regexp flags:</p>
<div class="highlight"><pre><span></span><code>&gt; re_matches(re_pattern(&quot;abc&quot;,&quot;i&quot;), &quot;ABC&quot;)

=&gt; ABC
</code></pre></div>
<p>There are other flags but 'i', see the full list in the 
<a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java documentation</a>.
The characters used for flags are the same that are used for embedded flags.</p>
<h3 id="matching-a-regex-to-a-string-with-groups">Matching a Regex to a String with Groups</h3>
<p>Very often, you want to match an entire string. The function to do
that is called <code>re-matches</code>. it takes a regex and a
string and returns the result of the match.</p>
<div class="highlight"><pre><span></span><code><span class="n">re_matches</span><span class="p">(</span><span class="o">&lt;</span><span class="n">REGEX</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">RESULT</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>
<p>The result it returns is a little complex. There are three things it can return.</p>
<p>If the whole string does not match, re-matches returns NIL.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;xyz&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;abc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;zzzabcxxx&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;(a)bc&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hello, world&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<p>If the string does match, and there are no groups (parentheses) in the
regex, then it returns the matched string.</p>
<div class="highlight"><pre><span></span><code>&gt; re_matches(r&quot;abc&quot;,&quot;abc&quot;)

=&gt; abc

&gt; re_matches(r&quot;\d+&quot;, &quot;3324&quot;)

=&gt; 3324
</code></pre></div>
<p>Note, that can use re-matches as the test expression of a conditional when matched string cannot be empty:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;</span><span class="err">\</span><span class="sr">d+&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is all digits&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">else</span><span class="w"></span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is not all digits&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Since the implicit Boolean value of an empty string is false, so if a regexp can match
an empty string, you need to explicitly test that the returned value is not null:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="n">notnilp</span><span class="p">(</span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;</span><span class="err">\</span><span class="sr">d+&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"></span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is all digits&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">else</span><span class="w"></span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is not all digits&quot;</span><span class="p">)</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>If it matches and there are groups, then it returns a list, its first
element is the entire match. The remaining elements are the group
matches.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;abc(.*)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;abcxyz&quot;</span><span class="p">)</span><span class="w"> </span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;abcxyz&quot;</span><span class="w"> </span><span class="s">&quot;xyz&quot;</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">re_matches</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;(a+)(b+)(</span><span class="err">\</span><span class="sr">d+)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;abb234&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;abb234&quot;</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="s">&quot;bb&quot;</span><span class="w"> </span><span class="s">&quot;234&quot;</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="finding-a-regex-substring-within-a-string-with-groups">Finding a regex substring within a string with groups</h3>
<p>Sometimes we want to find a match within a string. <code>re-find</code> returns the
first match within the string. The return values are similar to
re-matches.</p>
<ol>
<li>No match returns nil</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">re_find</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;sss&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Loch Ness&quot;</span><span class="p">)</span><span class="w"> </span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<ol>
<li>Match without groups returns the matched string</li>
</ol>
<div class="highlight"><pre><span></span><code>re_find(r&quot;s+&quot;, &quot;dress&quot;) 
=&gt; &quot;ss&quot;
</code></pre></div>
<ol>
<li>Match with groups returns a list</li>
</ol>
<div class="highlight"><pre><span></span><code>re_find(r&quot;s+(.*)(s+)&quot;,&quot;success&quot;) 

=&gt; [&quot;success&quot; &quot;ucces&quot; &quot;s&quot;]
</code></pre></div>
<h3 id="finding-all-substrings-that-match-within-a-string">Finding all substrings that match within a string</h3>
<p>To find all substrings that match within a string use <code>re-seq</code>.
<code>re-seq</code> returns a lazy seq of all of the matches.
The elements of the seq are whatever type re-find would have returned.</p>
<div class="highlight"><pre><span></span><code><span class="n">append</span><span class="p">([],</span><span class="n">re_seq</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;s+&quot;</span><span class="p">,</span><span class="s">&quot;mississippi&quot;</span><span class="p">))</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;ss&quot;</span><span class="w"> </span><span class="s">&quot;ss&quot;</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">append</span><span class="p">([],</span><span class="w"> </span><span class="n">re_seq</span><span class="p">(</span><span class="sa">r</span><span class="sr">&quot;[a-zA-Z](</span><span class="err">\</span><span class="sr">d+)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;abc x123 b44 234&quot;</span><span class="p">))</span><span class="w"> </span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="n">x123</span><span class="p">,</span><span class="w"> </span><span class="mi">123</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">b44</span><span class="p">,</span><span class="w"> </span><span class="mi">44</span><span class="p">]]</span><span class="w"></span>
</code></pre></div>
<p><code>append ()</code> materializes lazy sequence that re-seq returns so we can
see text of matched strings.</p>
<h2 id="compound-expressions">Compound Expressions</h2>
<p>Sometimes it is convenient or necessary to have a single expression that
evaluates in order a number of subordinate expressions and returns the value
of the last subexpression as value.  The previous subexpressions may be run
for their side effects or to compute intermediate values that will be used
to compute the return value in the last subexpression.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">q</span><span class="o">:=</span><span class="k">begin</span><span class="w"></span>
<span class="w">       </span><span class="n">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">       </span><span class="n">y</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">       </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Computing sum&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">       </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="n">Computing</span><span class="w"> </span><span class="n">sum</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
</code></pre></div>
<h2 id="conditionals">Conditionals</h2>
<p>Conditional evaluation allows portion of code to be evaluated or not evaluated
depending on a value of an expression (condition). 
In Explang The conditional operator has form</p>
<div class="highlight"><pre><span></span><code><span class="n">If</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="w">   </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is less than y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">elseif</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="w">   </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is greater than y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">else</span><span class="w"> </span>
<span class="w">   </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is equal to y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
<p>If the condition expression x &lt; y is true, then the corresponding
block is evaluated; otherwise the condition expression x &gt; y is
evaluated, and if it is true, the corresponding block is evaluated;
if; if none of the expression is true, the else block is evaluated. </p>
<p>Here it is in action:</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is less than y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">elseif</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is greater than y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;x is equal to y&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mi">2</span><span class="n">d1ef81a</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">y</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">y</span><span class="w"></span>
</code></pre></div>
<p>The <code>elseif</code> and <code>else</code> blocks are optional, and as many <code>elseif</code> blocks as
desired can be used. The condition expressions in the <code>if-elseif-else</code>
construct are evaluated until the first one evaluates to true, after
which the associated block is evaluated, and no further condition
expressions or blocks are evaluated.</p>
<p><code>if</code> blocks also return a value: this value is simply the return
value of the last executed statement in the branch that was chosen.
If no branch was chosen the return value is NIL:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">:=-</span><span class="mi">5</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">println</span><span class="p">(</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="s">&quot;positive&quot;</span><span class="w"> </span><span class="k">elseif</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="s">&quot;negative&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;zero&quot;</span><span class="w"> </span><span class="k">end</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">negative</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="k">end</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<h3 id="implicit-truth-values">Implicit Truth values</h3>
<p>The <code>if</code> operator checks the truth value of its condition. The comparison functions
like <code>&lt;</code> or <code>&gt;=</code>  return Java Boolean objects <code>true</code> or <code>false</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>
</code></pre></div>
<p>But, actually, in Explang all expressions have implicit truth values and thus can
be used in conditional expressions.</p>
<p>Generally, <code>false</code>, <code>NIL</code>, zero numbers of different types, 
empty lists, sets, strings  and other sequences have implicit <code>False</code> truth value. 
Other objects have  truth value of <code>true</code>. </p>
<p>For example </p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">no</span><span class="w"></span>
</code></pre></div>
<p>To check truth value of an expression one can use built-in function <code>bool</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">bool</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>
</code></pre></div>
<h2 id="the-logical-operators">The Logical operators</h2>
<p>The logical negation function is called <code>not</code>, it returns Boolean value, which is inverse of the
the truth value of its argument:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>
</code></pre></div>
<p>Logical operators <code>and</code> and <code>or</code>:</p>
<div class="highlight"><pre><span></span><code>true or false

=&gt; true
</code></pre></div>
<p>Like most other operators they can be used using function call syntax on any number of arguments.</p>
<p><code>and</code> evaluates its argument from left to right and returns false if it encounters an argument
 that has logical value false it stops evaluation and returns the encountered value.
 If no such argument encountered it returns true:</p>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">and</span><span class="p">()</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">and</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">and</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
</code></pre></div>
Similarly 'or' evaluates its argument from left to right and returns false if it encounters an argument
 that has logical value false it stops evaluation and returns the encountered value.
 If no such argument encountered it returns true:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">or</span><span class="p">()</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">false</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">or</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">or</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">true</span><span class="w"></span>
</code></pre></div>
<p>This behavior may be used to form an alternative to very short if statements.
Instead of using if one can write <code>&lt;condition&gt; AND &lt;statement&gt;</code> (which could
be read as: <code>&lt;condition&gt; and then &lt;statement&gt;</code>).  Similarly, instead of <code>if
NOT &lt;condition&gt; &lt;statement&gt; end</code>, one can write <code>&lt;condition&gt; OR &lt;statement&gt;;</code>
(which could be read as: <code>&lt;cond&gt; or else &lt;statement&gt;</code>).</p>
<p>For example, a recursive factorial routine could be defined like this:</p>
<div class="highlight"><pre><span></span><code>&gt; function fact(n)
           n &gt;= 0 or return(&quot;ERROR: n must be non-negative&quot;);
           n == 0 and return 1;
           n * fact(n-1);
  end;

=&gt; io.opsit.explang.Compiler$LAMBDA$1@2ea41516

&gt; fact(5)

=&gt; 120
</code></pre></div>
<h2 id="iteration-operators">Iteration Operators</h2>
<h3 id="for-in-loop"><code>for-in</code> loop</h3>
<p>To iterate through the elements of a collection or sequence  use <code>for-in</code> operator:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s">&quot;one&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;two&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;three&quot;</span><span class="w"> </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="n">one</span><span class="w"></span>
<span class="n">two</span><span class="w"></span>
<span class="n">three</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="n">NIL</span><span class="w"></span>
</code></pre></div>
<p>The NIL you see at the end is not printed out by the code in the loop.
They're the return values of the iteration expressions. One can give 
one additional argument that will be computed after the end of the iteration
and used as return value.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">stddev</span><span class="p">(</span><span class="n">args</span><span class="o">...</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="s">&quot;computes standard deviation sqrt(E(X-mu)^2)&quot;</span><span class="w"></span>
<span class="w">    </span><span class="n">avg</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="sa">f</span><span class="s">&quot;average&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span><span class="w"> </span><span class="c"># call average() we defined before</span><span class="w"></span>
<span class="w">    </span><span class="n">sum</span><span class="o">:=</span><span class="mf">0.0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">sum</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">args</span><span class="p">))</span><span class="w"> </span>
<span class="w">        </span><span class="n">sum</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">avg</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">avg</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">stddev</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mf">2.0</span><span class="w"></span>
</code></pre></div>
<p>To iterate over numeric ranges use for-in with range() that creates lazy sequences of numbers.
In this example we'll find prime numbers from 3 up to 1000:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="c"># only odd numbers</span><span class="w"></span>
<span class="w">    </span><span class="n">prime</span><span class="o">:=</span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="w">            </span><span class="n">prime</span><span class="o">:=</span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">prime</span><span class="w"></span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">num</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h3 id="while-loop"><code>while</code> loop</h3>
<p>To continue iterating while some condition is true, use <code>while</code> operator.</p>
<p>This is example will solve equation log(2-x)=x iterating while the solution
keeps changing more then defined limit;</p>
<div class="highlight"><pre><span></span><code>new:=1.0;
x:=0;
r:=(while (x-new)*(x-new) &gt; 0.000001
        println(x);
        x:=new;
        new:= log(2-x);
    end);

println(&quot;result=&quot;,r);

0
1.0
0.0
0.6931471805599453
0.26762181884443453
0.549495135702461
0.37191167810526626
0.48740651788686606
0.4138257153687164
0.4613250066022943
0.4309216521766674
0.45048840738203205
0.4379397797394399
0.4460056039781503
0.44082864577540753
0.4441544969443128
0.44201912973119606
result=0.44250995001095506
</code></pre></div>
<h3 id="map-iterator"><code>map</code> iterator</h3>
<p>The <code>map</code> function takes a function and a sequence and returns the
result of applying the function to successive elements.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>Actually it can take any number of sequences, and keeps going till the shortest runs out.
The function must accept same number of arguments.</p>
<div class="highlight"><pre><span></span><code>&gt; map((x,y) -&gt; x + y, [1, 2, 3, 4], [100, 200, 300])

=&gt; [101, 202, 303]
</code></pre></div>
<h3 id="filter"><code>filter</code></h3>
<p>There are other functions like <code>map</code> that apply functions to successive
elements of sequences. The most commonly used is <code>filter</code>, which
returns the elements satisfying some test.</p>
<div class="highlight"><pre><span></span><code>&gt; filter( x -&gt; x &gt; 0, [-2, -1, 0, 1, 2, 3])

=&gt; [1, 2, 3]
</code></pre></div>
<h3 id="mapprod"><code>mapprod</code></h3>
<p><code>mapprod</code> returns a sequence consisting of the result of applying 
a function  to the Cartesian product of the lists:</p>
<div class="highlight"><pre><span></span><code><span class="n">mapprod</span><span class="p">(</span><span class="w"> </span><span class="sa">f</span><span class="s">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">])</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">A1</span><span class="p">,</span><span class="w"> </span><span class="n">B1</span><span class="p">,</span><span class="w"> </span><span class="n">C1</span><span class="p">,</span><span class="w"> </span><span class="n">A2</span><span class="p">,</span><span class="w"> </span><span class="n">B2</span><span class="p">,</span><span class="w"> </span><span class="n">C2</span><span class="p">,</span><span class="w"> </span><span class="n">A3</span><span class="p">,</span><span class="w"> </span><span class="n">B3</span><span class="p">,</span><span class="w"> </span><span class="n">C3</span><span class="p">,</span><span class="w"> </span><span class="n">A4</span><span class="p">,</span><span class="w"> </span><span class="n">B4</span><span class="p">,</span><span class="w"> </span><span class="n">C4</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<h3 id="reduce"><code>reduce</code></h3>
<p><code>reduce</code> allows to apply function to each sequence element while
accumulating the results.  The function must accept two
arguments. Initially it applies the function on the initial value and
the first element of the sequence, then <code>reduce</code> applies the function
on its previous result and next element in the list. <code>reduce</code> returns
result of it's last function application.</p>
<p>In this example we compute frequencies table for elements of a list of
objects. The initial value is an empty map <code>{}</code> of counters for elements
of sequence. The function increases counter for each encountered
element of the sequence (initially there is no entry, but it works
since NIL has implicit numeric value of 0).</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="o">:=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">reduce</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">assoc</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">{},</span><span class="w"> </span><span class="n">L</span><span class="p">);</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="o">=</span><span class="mi">1</span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<h3 id="handling-of-exceptions">Handling of Exceptions</h3>
<p>When exception it thrown and not handled the execution of Explang code stops
and control is passed to the calling Java code. When working in REPL it will
print information about the exception a dump of execution stack and return
control to the user, for example, lets define function to compute 
average of list of numbers.</p>
<p><div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="s">&quot;Compute average of the numbers in &#39;args&#39;&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">apply</span><span class="p">(</span><span class="sa">f</span><span class="s">&quot;+&quot;</span><span class="p">,</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">args</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mf">2e5</span><span class="n">d6d97</span><span class="w"></span>
</code></pre></div>
If we pass an empty list to this function we'll get an arithmetic exception:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">list</span><span class="p">());</span><span class="w"></span>
<span class="n">EXECUTION</span><span class="w"> </span><span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="n">java</span><span class="o">.</span><span class="n">lang</span><span class="o">.</span><span class="n">ArithmeticException</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">at</span><span class="o">:</span><span class="w"></span>
<span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="w">         </span><span class="n">INPUT23</span><span class="o">:</span><span class="n">line</span><span class="o">=</span><span class="mi">4</span><span class="o">:</span><span class="n">pos</span><span class="o">=</span><span class="mi">25</span><span class="o">:</span><span class="n">o</span><span class="o">=</span><span class="mi">123</span><span class="o">:</span><span class="n">len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Eargs</span><span class="o">&lt;</span><span class="mi">824318946</span><span class="o">&gt;</span><span class="w"></span>
<span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="n">average</span><span class="w">   </span><span class="n">INPUT26</span><span class="o">:</span><span class="n">line</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="n">pos</span><span class="o">=</span><span class="mi">12</span><span class="o">:</span><span class="n">o</span><span class="o">=</span><span class="mi">12</span><span class="o">:</span><span class="n">len</span><span class="o">=</span><span class="mi">0</span><span class="w">  </span><span class="n">Ctx</span><span class="o">&lt;</span><span class="mi">2128227771</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>
<p>The <code>try-catch-finally</code> statement allows to catch the exception and handle it
in user code. For example we can modify the function <code>average</code> that we used in
one of the previous chapters to handle the exception and return a Not-A-Number
value when called without the arguments:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="s">&quot;Compute average of the numbers in &#39;args&#39;. Returns a NaN if an error occurs.&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span>
<span class="w">      </span><span class="n">apply</span><span class="p">(</span><span class="sa">f</span><span class="s">&quot;+&quot;</span><span class="p">,</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">args</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="n">ex</span><span class="w"></span>
<span class="w">      </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Warning: average: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">double</span><span class="p">(</span><span class="s">&quot;NaN&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="w"></span>
<span class="o">=&gt;</span><span class="w"> </span><span class="n">io</span><span class="o">.</span><span class="n">opsit</span><span class="o">.</span><span class="n">explang</span><span class="o">.</span><span class="n">Compiler</span><span class="o">$</span><span class="n">LAMBDA</span><span class="o">$</span><span class="mi">1</span><span class="err">@</span><span class="mf">6e2</span><span class="n">c634b</span><span class="w"></span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>

<span class="o">&gt;</span><span class="w"> </span><span class="n">average</span><span class="p">(</span><span class="n">list</span><span class="p">())</span><span class="w"></span>
<span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="n">average</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">zero</span><span class="w"></span>

<span class="o">=&gt;</span><span class="w"> </span><span class="nb">NaN</span><span class="w"></span>
</code></pre></div>
<p>In the <code>catch</code> clause we specify the exception class that we want to catch,
variable to put the exception and list of expressions to be evaluated.  The
statement supports handling multiple exceptions with multiple catch
blocks. All Java exceptions inherit from the <code>java.lang.Exception</code> class, so
the above <code>catch</code> clause would handle any exception that can be thrown inside
the try block. It also means that order of catch blocks is important: first
should be handled more specific exceptions and then less specific according to
the inheritance hierarchy.</p>
<p>In code that works with resources like files or database connections or
modifies state of data structures there is often some clean-up tasks that need
to be performed after the code has finished its work. Exception handling may
complicate performing these tasks because it may cause cause block of code to
exit before reaching its normal end.</p>
<p>The <code>finally</code> block allows to perform some action after all the <code>try</code> and
<code>catch</code> code has been evaluated regardless of how it exits.  The code of the
finally block is evaluated only for side effects: it does not affect the
return value of the <code>try-catch-finally</code> statement.</p>
<p>Suppose we want to produce some HTML report on basis of some remote resource.
In case of error we want still to output HTML with error messages:</p>
<div class="highlight"><pre><span></span><code><span class="n">println</span><span class="p">(</span><span class="s">&quot;&lt;html&gt;&lt;body&gt;&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">try</span><span class="w"> </span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">data</span><span class="o">:=</span><span class="n">fetch_data</span><span class="p">(</span><span class="n">url</span><span class="p">),</span><span class="w"> </span><span class="n">formatted_data</span><span class="o">:=</span><span class="n">html_format</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">println</span><span class="p">(</span><span class="n">formatted_data</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;ERROR: IO error reading data: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">);</span><span class="w"></span>
<span class="k">catch</span><span class="w"> </span><span class="n">ex</span><span class="w"> </span>
<span class="w">  </span><span class="n">println</span><span class="p">(</span><span class="s">&quot;ERROR: some exception producing report: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="o">.</span><span class="n">message</span><span class="p">);</span><span class="w"></span>
<span class="k">finally</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">println</span><span class="w"> </span><span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)));</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h2 id="scope-and-binding-of-variables">Scope and Binding of Variables</h2>
<p>When an Explang program is executing, the variable bindings live in a
hierarchy of contexts (scopes).  The initial scope, in which the program code
starts executing, is called the 'global scope'. Some language constructions
introduce their own local scopes.</p>
<p>For example, when a function is called, its arguments receive local values,
which are the actual arguments supplied to the function call and those binding
have effect only during execution of this function.  The context of the code,
from which this function has been called, becomes parent context of the newly
created scope. Establishing the binding in local context may shadow the
bindings in the parent context.</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">             </span><span class="c"># x and y receive values 1 and 2</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c"># accordingly in the global context</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">printit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c"># x is bound locally and</span><span class="w"></span>
<span class="w">  </span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w">        </span><span class="c"># y is used freely inside the function</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="n">printit</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">         </span><span class="c"># y inside function refers to the global context</span><span class="w"></span>
<span class="cm">#=&gt; [3, 2)          # will return list (3 2)</span>

<span class="cm">x                   # will still return 1</span>

<span class="cm">y := 3;             # now we change the y value to 3 in the global</span>

<span class="cm">printit(3);         # now y inside the function refers to the new value</span>
<span class="cm">#=&gt; [3, 3]          # will return list (3 3)</span>
</code></pre></div>
<p>The function <code>printit</code> refers to <code>y</code>. This is a free reference in the sense that
there is no binding to y inside the function. When we refer to <code>y</code> inside the
function it refers to the binding in the parent context. On the other hand <code>x</code></p>
<p>Such type of variable binding is called <em>Dynamic Binding</em>. When variable is
dynamically bound, its current binding is simply the most recently created
local binding for that name. Or the global binding if there is no such local
binding.</p>
<h2 id="let-construction"><code>LET</code> construction</h2>
<p><code>let</code> is another construction that introduces local scope of execution. It receives
list of variable bindings that will be established in the newly created scope:</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="o">:=</span><span class="w"> </span><span class="o">-</span><span class="mi">99</span><span class="p">;</span><span class="w">            </span><span class="c"># x receives an initial value of -99</span><span class="w"></span>

<span class="k">function</span><span class="w"> </span><span class="n">incx</span><span class="p">()</span><span class="w"></span>
<span class="w"> </span><span class="n">x</span><span class="o">:=</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">          </span><span class="c"># increment x and return its value</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="k">let</span><span class="w"> </span><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">:=</span><span class="mi">10</span><span class="w">     </span><span class="c"># x is bound to 1 locally, y to 10</span><span class="w"></span>
<span class="w">  </span><span class="n">incx</span><span class="p">();</span><span class="w">           </span><span class="c"># executes inside newly created context</span><span class="w"></span>
<span class="w">  </span><span class="n">incx</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="cm">#=&gt; [3, 10]          # will return list (3 10)</span>

<span class="cm">(incx)               # will return -98</span>
<span class="cm">x                    # x now is -98</span>
<span class="cm">y                    # will fail because let</span>
<span class="cm">                     # did not establish global binding for y</span>
</code></pre></div>
<h2 id="the-assignment-operator-and-its-global-and-local-modifiers">The Assignment Operator <code>:=</code> and its <code>GLOBAL</code> and <code>LOCAL</code> Modifiers</h2>
<p>As we have seen the ':=' operator serves to establish variable bindings.  The
assignment can be prefixed with optional modifiers <code>global</code> or <code>local</code> that
change handling of variable scope by the assignment operation.</p>
<p>With the <code>local</code> modifier the binding is always performed in the local
context. If there is an variable with same name in one of parent contexts it
will be shadowed.</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="w">                </span><span class="c"># set value of x in the global context</span><span class="w"></span>

<span class="k">let</span><span class="w"> </span><span class="n">z</span><span class="o">:=</span><span class="mi">0</span><span class="w">            </span><span class="c"># introduce local context with z = 0</span><span class="w"></span>
<span class="w">  </span><span class="k">local</span><span class="w"> </span><span class="n">x</span><span class="o">:=</span><span class="mi">2</span><span class="p">;</span><span class="w">       </span><span class="c"># set values in local context</span><span class="w"></span>
<span class="w">  </span><span class="k">local</span><span class="w"> </span><span class="n">y</span><span class="o">:=</span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">local</span><span class="w"> </span><span class="n">z</span><span class="o">:=</span><span class="mi">4</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="p">;</span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>

<span class="n">x</span><span class="w">                   </span><span class="c"># x is still 1 in the global context</span><span class="w"></span>
<span class="cm">#=&gt; 1</span>

<span class="cm">y                   # will return error, y is unbound in the global context</span>
<span class="cm">z                   # will return error, z is unbound in the global context</span>
</code></pre></div>
<p><code>:=</code> without modifiers, on the other hand, will change variable value if it
exists in parent contexts. It will start looking for the variable binding in
the local context and continue looking up in the contexts hierarchy. If it
finds such a binding it will change it to the new value.If no such binding
exists it will establish a new binding in the local context.</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="w">                </span><span class="c"># set value of x in the global context</span><span class="w"></span>

<span class="k">let</span><span class="w"> </span><span class="n">z</span><span class="o">:=</span><span class="mi">0</span><span class="w">            </span><span class="c"># introduce local context with z = 0</span><span class="w"></span>
<span class="w">  </span><span class="n">x</span><span class="o">:=</span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c"># set value in global context</span><span class="w"></span>
<span class="w">  </span><span class="n">y</span><span class="o">:=</span><span class="mi">3</span><span class="p">;</span><span class="w">             </span><span class="c"># set value in local context</span><span class="w"></span>
<span class="w">  </span><span class="n">z</span><span class="o">:=</span><span class="mi">4</span><span class="p">;</span><span class="w">             </span><span class="c"># set value in local context</span><span class="w"></span>
<span class="w">  </span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="p">;</span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>

<span class="n">x</span><span class="w">                   </span><span class="c"># x is changed to 2 in the global context</span><span class="w"></span>
<span class="cm">#=&gt; 2</span>
<span class="cm">y                   # will return error, y is unbound in the global context</span>
<span class="cm">z                   # will return error, z is unbound in the global context</span>
</code></pre></div>
<p>With the <code>global</code> modifier it will look for an existing binding and update it
in the same way as with no modifiers.  But in the case when no such binding
exists it will establish a new binding in the initial context.</p>
<div class="highlight"><pre><span></span><code><span class="n">x</span><span class="o">:=</span><span class="mi">1</span><span class="w">                </span><span class="c"># set value of x in the global context</span><span class="w"></span>

<span class="k">let</span><span class="w"> </span><span class="n">z</span><span class="o">:=</span><span class="mi">0</span><span class="w">            </span><span class="c"># introduce local context with z = 0</span><span class="w"></span>
<span class="w">  </span><span class="k">global</span><span class="w"> </span><span class="n">x</span><span class="o">:=</span><span class="mi">2</span><span class="p">;</span><span class="w">      </span><span class="c"># set x, y in the global</span><span class="w"></span>
<span class="w">  </span><span class="k">global</span><span class="w"> </span><span class="n">y</span><span class="o">:=</span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">global</span><span class="w"> </span><span class="n">z</span><span class="o">:=</span><span class="mi">4</span><span class="p">;</span><span class="w">      </span><span class="c"># and z in the local context</span><span class="w"></span>
<span class="w">  </span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="p">;</span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="w"></span>

<span class="n">x</span><span class="w">                   </span><span class="c"># x is changed to 2 in the global context</span><span class="w"></span>
<span class="cm">#=&gt; 2</span>
<span class="cm">y                   # y is now bound to 3 in the global context</span>
<span class="cm">#=&gt; 3</span>
<span class="cm">z                   # will return error, z is unbound in the global context</span>
</code></pre></div>
<p>In general, when writing generally useful functions, one would want to use
<code>LET</code> or <code>local</code> assignments to declare local variables and avoid modifying
variables with same name in outer scopes.</p>
<p>On the other hand, when writing specialized functions that will be run in
execution contexts that are known beforehand, ability to access and modify
global variables from inside functions allows to avoid passing lots of
variables or complex data structures as function arguments.</p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../explang-extending/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Extending Explang in Java" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Extending Explang in Java
            </div>
          </div>
        </a>
      
      
        
        <a href="../explang-alg-funcs-by-package/" class="md-footer__link md-footer__link--next" aria-label="Next: Explang/Alg funcs by Package" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Explang/Alg funcs by Package
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>